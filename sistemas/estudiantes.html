<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TECNO-PIA | Gesti√≥n de Estudiantes - Sistema de Evaluaci√≥n Tecnol√≥gica MEP</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', system-ui, sans-serif; }
        
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f8fafc;
            --gray: #64748b;
            --border: #e2e8f0;
        }
        
        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #fef7ff 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            border: 1px solid var(--border);
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .logo-badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .nav-tabs {
            display: flex;
            gap: 5px;
            background: rgba(255,255,255,0.1);
            padding: 5px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        
        .nav-tab {
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            display: inline-block;
        }
        
        .nav-tab:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .nav-tab.active {
            background: white;
            color: var(--primary);
        }
        
        /* Main Layout */
        .main-content {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 800px;
        }
        
        /* Sidebar */
        .sidebar {
            background: var(--light);
            border-right: 1px solid var(--border);
            padding: 30px 0;
        }
        
        .sidebar-section {
            padding: 0 25px;
            margin-bottom: 30px;
        }
        
        .sidebar-title {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray);
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .sidebar-menu li {
            margin-bottom: 5px;
        }
        
        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            color: var(--dark);
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.2s;
            font-weight: 500;
            font-size: 14px;
        }
        
        .sidebar-menu a:hover {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary);
        }
        
        .sidebar-menu a.active {
            background: var(--primary);
            color: white;
        }
        
        .module-badge {
            margin-left: auto;
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .tech-badge-1 { background: rgba(37, 99, 235, 0.1); color: var(--primary); }
        .tech-badge-2 { background: rgba(124, 58, 237, 0.1); color: var(--secondary); }
        .tech-badge-3 { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .tech-badge-4 { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        
        /* Content Area */
        .content {
            padding: 30px;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
        }
        
        .page-subtitle {
            color: var(--gray);
            margin-top: 5px;
            font-size: 14px;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            border: 1px solid var(--border);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        /* Colors for icons */
        .icon-blue { background: rgba(37, 99, 235, 0.1); color: var(--primary); }
        .icon-purple { background: rgba(124, 58, 237, 0.1); color: var(--secondary); }
        .icon-green { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .icon-orange { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        
        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            padding: 25px;
            border-radius: 16px;
            background: white;
            border: 1px solid var(--border);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 14px;
        }
        
        .stat-change {
            font-size: 12px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .change-up { color: var(--success); }
        .change-down { color: var(--danger); }
        
        /* Tables */
        .table-container {
            background: white;
            border-radius: 16px;
            border: 1px solid var(--border);
            overflow: hidden;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px;
            border-bottom: 1px solid var(--border);
        }
        
        .table-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Buttons */
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 1px solid var(--border);
        }
        
        .btn-secondary:hover {
            background: #e2e8f0;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }
        
        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 25px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            padding: 25px;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 25px;
        }
        
        .tab {
            padding: 15px 30px;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* AI Insights */
        .ai-insight {
            background: linear-gradient(135deg, #f0f9ff 0%, #f8fafc 100%);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .ai-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .ai-title {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-success { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .badge-warning { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .badge-danger { background: rgba(239, 68, 68, 0.1); color: var(--danger); }
        .badge-info { background: rgba(37, 99, 235, 0.1); color: var(--primary); }
        
        /* Progress bars */
        .progress {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            border-radius: 4px;
            transition: width 0.3s;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <h1>TECNO-PIA</h1>
                <div class="logo-badge">Sistema de Evaluaci√≥n Tecnol√≥gica MEP</div>
            </div>
            <div class="nav-tabs">
                <a href="principal.html" class="nav-tab">Principal</a>
                <a href="estudiantes.html" class="nav-tab active">Estudiantes</a>
                <a href="indicadores.html" class="nav-tab">Indicadores</a>
                <a href="cotidiano.html" class="nav-tab">Cotidiano</a>
                <a href="tareas.html" class="nav-tab">Tareas</a>
                <a href="proyectos.html" class="nav-tab">Proyectos</a>
                <a href="pruebas.html" class="nav-tab">Pruebas</a>
                <a href="asistencia.html" class="nav-tab">Asistencia</a>
                <a href="reportes.html" class="nav-tab">Reportes</a>
                <a href="recursos.html" class="nav-tab">Recursos</a>
                <a href="inteligencia.html" class="nav-tab">Inteligencia</a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">Gesti√≥n Estudiantil</div>
                    <ul class="sidebar-menu">
                        <li><a href="#" class="active">
                            <span>üìã Lista de Estudiantes</span>
                            <span class="module-badge tech-badge-1">TECNO</span>
                        </a></li>
                        <li><a href="#">
                            <span>‚ûï Agregar Estudiante</span>
                            <span class="module-badge tech-badge-2">TECNO</span>
                        </a></li>
                        <li><a href="#">
                            <span>üìÅ Grupos/Niveles</span>
                            <span class="module-badge tech-badge-3">TECNO</span>
                        </a></li>
                        <li><a href="#">
                            <span>üìä Historial Acad√©mico</span>
                            <span class="module-badge tech-badge-4">TECNO</span>
                        </a></li>
                        <li><a href="#">
                            <span>üì§ Importar CSV</span>
                            <span class="module-badge tech-badge-1">MEP</span>
                        </a></li>
                        <li><a href="#">
                            <span>üì• Exportar MEP</span>
                            <span class="module-badge tech-badge-2">MEP</span>
                        </a></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">√Åreas Tecnol√≥gicas PNFT</div>
                    <ul class="sidebar-menu">
                        <li><a href="#">
                            <span>üíª Apropiaci√≥n Tecnol√≥gica</span>
                            <span class="module-badge tech-badge-1">PNFT</span>
                        </a></li>
                        <li><a href="#">
                            <span>‚ö° Programaci√≥n</span>
                            <span class="module-badge tech-badge-2">PNFT</span>
                        </a></li>
                        <li><a href="#">
                            <span>ü§ñ Computaci√≥n F√≠sica</span>
                            <span class="module-badge tech-badge-3">PNFT</span>
                        </a></li>
                        <li><a href="#">
                            <span>üß† Ciencia de Datos</span>
                            <span class="module-badge tech-badge-4">PNFT</span>
                        </a></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">An√°lisis Inteligente</div>
                    <ul class="sidebar-menu">
                        <li><a href="#">
                            <span>üß† Portafolios Digitales</span>
                        </a></li>
                        <li><a href="#">
                            <span>üìà Progreso Inteligente</span>
                        </a></li>
                        <li><a href="#">
                            <span>‚ö†Ô∏è Alertas Tempranas</span>
                        </a></li>
                        <li><a href="#">
                            <span>üîÆ Predicci√≥n de Desempe√±o</span>
                        </a></li>
                        <li><a href="#">
                            <span>üì± Comunicaci√≥n Familias</span>
                        </a></li>
                        <li><a href="#">
                            <span>üéØ Recomendaciones IA</span>
                        </a></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">Niveles Tecnol√≥gicos</div>
                    <ul class="sidebar-menu">
                        <li><a href="#"><span>üë∂ Maternal (0-3 a√±os)</span></a></li>
                        <li><a href="#"><span>üßí Preescolar (4-6 a√±os)</span></a></li>
                        <li><a href="#"><span>üë¶ 1¬∞-3¬∞ Primaria</span></a></li>
                        <li><a href="#"><span>üßë 4¬∞-6¬∞ Primaria</span></a></li>
                        <li><a href="#"><span>üë± 7¬∞-9¬∞ Secundaria</span></a></li>
                    </ul>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content">
                <!-- Page Header -->
                <div class="page-header">
                    <div>
                        <h1 class="page-title">Gesti√≥n de Estudiantes</h1>
                        <p class="page-subtitle">M√≥dulo de Gesti√≥n Estudiantil con Portafolios Digitales</p>
                    </div>
                    <div class="table-actions">
                        <button class="btn btn-secondary" onclick="exportData()">
                            üì§ Exportar CSV MEP
                        </button>
                        <button class="btn btn-primary" onclick="showImportModal()">
                            üì• Importar Estudiantes
                        </button>
                        <button class="btn btn-success" onclick="showAddStudentModal()">
                            üë®‚Äçüéì Agregar Estudiante
                        </button>
                    </div>
                </div>

                <!-- Stats Overview -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalStudents">0</div>
                        <div class="stat-label">Total Estudiantes</div>
                        <div class="stat-change change-up">
                            ‚Üë 12% desde √∫ltima semana
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activePortfolios">0</div>
                        <div class="stat-label">Portafolios Activos</div>
                        <div class="stat-change change-up">
                            ‚Üë 8% nuevos proyectos
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgProgress">0%</div>
                        <div class="stat-label">Progreso Promedio</div>
                        <div class="stat-change change-up">
                            ‚Üë 3.2% mejor√≠a mensual
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="needsAttention">0</div>
                        <div class="stat-label">Requieren Atenci√≥n</div>
                        <div class="stat-change change-down">
                            ‚Üì 2 estudiantes mejoraron
                        </div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('list')">üìã Lista de Estudiantes</div>
                    <div class="tab" onclick="switchTab('groups')">üë• Grupos por Nivel</div>
                    <div class="tab" onclick="switchTab('portfolios')">üìÅ Portafolios Digitales</div>
                    <div class="tab" onclick="switchTab('analytics')">üìà An√°lisis Inteligente</div>
                </div>

                <!-- Tab Content: Student List -->
                <div id="tab-list" class="tab-content active">
                    <div class="table-container">
                        <div class="table-header">
                            <div>
                                <h3 style="font-size: 18px; font-weight: 600;">Registro de Estudiantes</h3>
                                <p style="color: var(--gray); margin-top: 5px; font-size: 14px;">
                                    Gesti√≥n de estudiantes con integraci√≥n de portafolios digitales tecnol√≥gicos
                                </p>
                            </div>
                            <div class="table-actions">
                                <input type="text" id="searchStudents" class="form-control" style="width: 250px;" 
                                       placeholder="üîç Buscar estudiante..." onkeyup="searchStudents()">
                                <select id="filterLevel" class="form-control" style="width: 150px;" onchange="filterStudents()">
                                    <option value="">Todos los niveles</option>
                                    <option value="maternal">Maternal</option>
                                    <option value="preescolar">Preescolar</option>
                                    <option value="1-3">1¬∞-3¬∞ Primaria</option>
                                    <option value="4-6">4¬∞-6¬∞ Primaria</option>
                                    <option value="7-9">7¬∞-9¬∞ Secundaria</option>
                                </select>
                            </div>
                        </div>

                        <div style="overflow-x: auto;">
                            <table id="studentsTable" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--light);">
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">ID</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">Nombre Completo</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">Nivel</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">Edad</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">Progreso</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">Portafolio</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">Estado</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: var(--dark);">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="studentsTableBody">
                                    <!-- Students will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- AI Insights -->
                    <div class="ai-insight">
                        <div class="ai-header">
                            <div style="font-size: 20px;">ü§ñ</div>
                            <div class="ai-title">Recomendaciones de Inteligencia Artificial</div>
                        </div>
                        <div id="aiRecommendations" style="font-size: 14px; color: var(--dark);">
                            Analizando patrones de desempe√±o tecnol√≥gico...
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Groups -->
                <div id="tab-groups" class="tab-content">
                    <div class="dashboard-grid">
                        <!-- Maternal Group Card -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">üë∂ Maternal (0-3 a√±os)</div>
                                <div class="card-icon icon-blue">üë∂</div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: var(--gray);">Estudiantes:</span>
                                    <span style="font-weight: 600;" id="maternalCount">0</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: 40%; background: var(--primary);"></div>
                                </div>
                            </div>
                            <div style="font-size: 13px; color: var(--gray);">
                                Competencias tecnol√≥gicas b√°sicas: interacci√≥n con dispositivos, reconocimiento de formas digitales
                            </div>
                        </div>

                        <!-- Preschool Group Card -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">üßí Preescolar (4-6 a√±os)</div>
                                <div class="card-icon icon-purple">üßí</div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: var(--gray);">Estudiantes:</span>
                                    <span style="font-weight: 600;" id="preschoolCount">0</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: 65%; background: var(--secondary);"></div>
                                </div>
                            </div>
                            <div style="font-size: 13px; color: var(--gray);">
                                Introducci√≥n a Scratch Jr., programaci√≥n por bloques, rob√≥tica b√°sica
                            </div>
                        </div>

                        <!-- Primary 1-3 Group Card -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">üë¶ 1¬∞-3¬∞ Primaria</div>
                                <div class="card-icon icon-green">üë¶</div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: var(--gray);">Estudiantes:</span>
                                    <span style="font-weight: 600;" id="primary13Count">0</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: 80%; background: var(--success);"></div>
                                </div>
                            </div>
                            <div style="font-size: 13px; color: var(--gray);">
                                Scratch avanzado, introducci√≥n a Tinkercad, circuitos simples
                            </div>
                        </div>

                        <!-- Primary 4-6 Group Card -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">üßë 4¬∞-6¬∞ Primaria</div>
                                <div class="card-icon icon-orange">üßë</div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: var(--gray);">Estudiantes:</span>
                                    <span style="font-weight: 600;" id="primary46Count">0</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: 75%; background: var(--warning);"></div>
                                </div>
                            </div>
                            <div style="font-size: 13px; color: var(--gray);">
                                Python b√°sico, dise√±o 3D, rob√≥tica con Arduino, desarrollo web simple
                            </div>
                        </div>

                        <!-- Secondary 7-9 Group Card -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">üë± 7¬∞-9¬∞ Secundaria</div>
                                <div class="card-icon icon-blue">üë±</div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: var(--gray);">Estudiantes:</span>
                                    <span style="font-weight: 600;" id="secondaryCount">0</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: 90%; background: var(--primary);"></div>
                                </div>
                            </div>
                            <div style="font-size: 13px; color: var(--gray);">
                                Desarrollo de apps, inteligencia artificial, IoT, proyectos tecnol√≥gicos complejos
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Portfolios -->
                <div id="tab-portfolios" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üìÅ Portafolios Digitales</div>
                            <button class="btn btn-primary btn-sm" onclick="generateAllPortfolios()">
                                üöÄ Generar Todos los Portafolios
                            </button>
                        </div>
                        <div id="portfoliosContainer" style="min-height: 400px;">
                            <!-- Portfolios will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Analytics -->
                <div id="tab-analytics" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üìà An√°lisis Predictivo - Inteligencia</div>
                        </div>
                        <div class="form-grid">
                            <div>
                                <h4 style="margin-bottom: 15px; color: var(--dark);">Predicci√≥n de Desempe√±o</h4>
                                <div id="performancePrediction">
                                    <!-- AI predictions will be shown here -->
                                </div>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 15px; color: var(--dark);">Alertas Tempranas</h4>
                                <div id="earlyAlerts">
                                    <!-- Early alerts will be shown here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Add Student -->
    <div id="addStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 20px; font-weight: 600;">üë®‚Äçüéì Agregar Nuevo Estudiante</h2>
                <button onclick="closeModal('addStudentModal')" style="background: none; border: none; font-size: 24px; cursor: pointer; color: var(--gray);">√ó</button>
            </div>
            <div class="modal-body">
                <form id="addStudentForm" onsubmit="addStudent(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">C√©dula / Identificaci√≥n</label>
                            <input type="text" class="form-control" id="studentId" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nombre Completo</label>
                            <input type="text" class="form-control" id="studentName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nivel Tecnol√≥gico</label>
                            <select class="form-control" id="studentLevel" required>
                                <option value="">Seleccionar nivel</option>
                                <option value="maternal">Maternal (0-3 a√±os)</option>
                                <option value="preescolar">Preescolar (4-6 a√±os)</option>
                                <option value="1-3">1¬∞-3¬∞ Primaria</option>
                                <option value="4-6">4¬∞-6¬∞ Primaria</option>
                                <option value="7-9">7¬∞-9¬∞ Secundaria</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Edad</label>
                            <input type="number" class="form-control" id="studentAge" min="0" max="18" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Correo Electr√≥nico</label>
                            <input type="email" class="form-control" id="studentEmail">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tel√©fono (opcional)</label>
                            <input type="tel" class="form-control" id="studentPhone">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Observaciones</label>
                        <textarea class="form-control" id="studentNotes" rows="3"></textarea>
                    </div>
                    <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 25px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('addStudentModal')">
                            Cancelar
                        </button>
                        <button type="submit" class="btn btn-success">
                            üíæ Guardar Estudiante
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Import Students -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 20px; font-weight: 600;">üì• Importar Estudiantes desde CSV/Excel MEP</h2>
                <button onclick="closeModal('importModal')" style="background: none; border: none; font-size: 24px; cursor: pointer; color: var(--gray);">√ó</button>
            </div>
            <div class="modal-body">
                <div style="background: var(--light); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px; color: var(--dark);">Formato Compatible MEP:</h4>
                    <pre style="font-size: 12px; color: var(--gray);">
ID,Nombre,Apellido,Nivel,Edad,Email,Telefono
2024001,Juan,Perez,4-6,10,juan@email.com,8888-8888
2024002,Maria,Gomez,1-3,8,maria@email.com,7777-7777
                    </pre>
                </div>
                <div class="form-group">
                    <label class="form-label">Seleccionar archivo CSV o Excel</label>
                    <input type="file" class="form-control" id="csvFile" accept=".csv,.xlsx,.xls">
                </div>
                <div class="form-group">
                    <label class="form-label">O pegar datos CSV:</label>
                    <textarea class="form-control" id="csvData" rows="6" placeholder="Pegue aqu√≠ los datos en formato CSV..."></textarea>
                </div>
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 25px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('importModal')">
                        Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="importCSV()">
                        üì§ Importar Datos
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Student Portfolio -->
    <div id="portfolioModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 20px; font-weight: 600;" id="portfolioTitle">Portafolio Digital</h2>
                <button onclick="closeModal('portfolioModal')" style="background: none; border: none; font-size: 24px; cursor: pointer; color: var(--gray);">√ó</button>
            </div>
            <div class="modal-body" id="portfolioContent">
                <!-- Portfolio content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Database initialization
        const DB_NAME = 'TECNO_PIA_STUDENTS';
        
        // Initialize database with sample data if empty
        function initializeDatabase() {
            if (!localStorage.getItem(DB_NAME)) {
                const sampleStudents = [
                    {
                        id: '20241001',
                        name: 'Ana Sof√≠a Rodr√≠guez',
                        level: 'preescolar',
                        age: 5,
                        email: 'ana.rodriguez@email.com',
                        progress: 65,
                        portfolio: true,
                        status: 'active',
                        techAreas: ['Apropiaci√≥n', 'Programaci√≥n'],
                        pnftLevel: 'Preescolar - Nivel 1',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241002',
                        name: 'Carlos Enrique P√©rez',
                        level: '1-3',
                        age: 8,
                        email: 'carlos.perez@email.com',
                        progress: 82,
                        portfolio: true,
                        status: 'active',
                        techAreas: ['Programaci√≥n', 'Rob√≥tica'],
                        pnftLevel: 'I Ciclo - Nivel 2',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241003',
                        name: 'Mar√≠a Fernanda G√≥mez',
                        level: '4-6',
                        age: 11,
                        email: 'maria.gomez@email.com',
                        progress: 78,
                        portfolio: true,
                        status: 'active',
                        techAreas: ['Rob√≥tica', 'Ciencia de Datos'],
                        pnftLevel: 'II Ciclo - Nivel 3',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241004',
                        name: 'Juan Diego Mart√≠nez',
                        level: '7-9',
                        age: 14,
                        email: 'juan.martinez@email.com',
                        progress: 91,
                        portfolio: true,
                        status: 'active',
                        techAreas: ['Ciencia de Datos', 'Apropiaci√≥n'],
                        pnftLevel: 'III Ciclo - Nivel 4',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241005',
                        name: 'Valentina Morales',
                        level: 'preescolar',
                        age: 6,
                        email: 'valentina.morales@email.com',
                        progress: 45,
                        portfolio: false,
                        status: 'needs_attention',
                        techAreas: ['Apropiaci√≥n'],
                        pnftLevel: 'Preescolar - Nivel 1',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241006',
                        name: 'Diego Alejandro Castro',
                        level: '1-3',
                        age: 9,
                        email: 'diego.castro@email.com',
                        progress: 73,
                        portfolio: true,
                        status: 'active',
                        techAreas: ['Programaci√≥n'],
                        pnftLevel: 'I Ciclo - Nivel 2',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241007',
                        name: 'Sof√≠a Isabel Ram√≠rez',
                        level: '4-6',
                        age: 10,
                        email: 'sofia.ramirez@email.com',
                        progress: 88,
                        portfolio: true,
                        status: 'active',
                        techAreas: ['Rob√≥tica', 'Programaci√≥n'],
                        pnftLevel: 'II Ciclo - Nivel 3',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241008',
                        name: 'Andr√©s Felipe L√≥pez',
                        level: '7-9',
                        age: 13,
                        email: 'andres.lopez@email.com',
                        progress: 67,
                        portfolio: true,
                        status: 'warning',
                        techAreas: ['Ciencia de Datos'],
                        pnftLevel: 'III Ciclo - Nivel 4',
                        lastUpdated: new Date().toISOString()
                    },
                    {
                        id: '20241009',
                        name: 'Camila Esperanza Ruiz',
                        level: 'maternal',
                        age: 2,
                        email: 'camila.ruiz@email.com',
                        progress: 30,
                        portfolio: false,
                        status: 'active',
                        techAreas: ['Apropiaci√≥n'],
                        pnftLevel: 'Maternal - Nivel 0',
                        lastUpdated: new Date().toISOString()
                    }
                ];
                
                localStorage.setItem(DB_NAME, JSON.stringify(sampleStudents));
            }
        }
        
        // Get all students
        function getStudents() {
            const students = localStorage.getItem(DB_NAME);
            return students ? JSON.parse(students) : [];
        }
        
        // Save students to database
        function saveStudents(students) {
            localStorage.setItem(DB_NAME, JSON.stringify(students));
            updateDashboard();
            renderStudentsTable();
        }
        
        // Update dashboard statistics
        function updateDashboard() {
            const students = getStudents();
            const total = students.length;
            const activePortfolios = students.filter(s => s.portfolio).length;
            const avgProgress = students.length > 0 
                ? Math.round(students.reduce((sum, s) => sum + (s.progress || 0), 0) / students.length)
                : 0;
            const needsAttention = students.filter(s => s.status === 'needs_attention' || s.status === 'warning').length;
            
            document.getElementById('totalStudents').textContent = total;
            document.getElementById('activePortfolios').textContent = activePortfolios;
            document.getElementById('avgProgress').textContent = avgProgress + '%';
            document.getElementById('needsAttention').textContent = needsAttention;
            
            // Update level counts
            const maternalCount = students.filter(s => s.level === 'maternal').length;
            const preschoolCount = students.filter(s => s.level === 'preescolar').length;
            const primary13Count = students.filter(s => s.level === '1-3').length;
            const primary46Count = students.filter(s => s.level === '4-6').length;
            const secondaryCount = students.filter(s => s.level === '7-9').length;
            
            document.getElementById('maternalCount').textContent = maternalCount;
            document.getElementById('preschoolCount').textContent = preschoolCount;
            document.getElementById('primary13Count').textContent = primary13Count;
            document.getElementById('primary46Count').textContent = primary46Count;
            document.getElementById('secondaryCount').textContent = secondaryCount;
            
            // Generate AI recommendations
            generateAIRecommendations(students);
        }
        
        // Render students table
        function renderStudentsTable(filteredStudents = null) {
            const students = filteredStudents || getStudents();
            const tbody = document.getElementById('studentsTableBody');
            tbody.innerHTML = '';
            
            students.forEach(student => {
                const statusBadge = getStatusBadge(student.status);
                const portfolioBadge = student.portfolio 
                    ? '<span class="badge badge-success">Activo</span>' 
                    : '<span class="badge badge-warning">Pendiente</span>';
                
                const row = `
                    <tr style="border-bottom: 1px solid var(--border);">
                        <td style="padding: 15px;">${student.id}</td>
                        <td style="padding: 15px; font-weight: 500;">${student.name}</td>
                        <td style="padding: 15px;">
                            <span class="badge badge-info">${getLevelName(student.level)}</span>
                        </td>
                        <td style="padding: 15px;">${student.age} a√±os</td>
                        <td style="padding: 15px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="flex: 1;">
                                    <div class="progress">
                                        <div class="progress-bar" style="width: ${student.progress}%;"></div>
                                    </div>
                                </div>
                                <span style="font-weight: 600;">${student.progress}%</span>
                            </div>
                        </td>
                        <td style="padding: 15px;">${portfolioBadge}</td>
                        <td style="padding: 15px;">${statusBadge}</td>
                        <td style="padding: 15px;">
                            <div style="display: flex; gap: 5px;">
                                <button class="btn btn-secondary btn-sm" onclick="viewPortfolio('${student.id}')" title="Ver portafolio">
                                    üëÅÔ∏è
                                </button>
                                <button class="btn btn-primary btn-sm" onclick="editStudent('${student.id}')" title="Editar">
                                    ‚úèÔ∏è
                                </button>
                                <button class="btn btn-danger btn-sm" onclick="deleteStudent('${student.id}')" title="Eliminar">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }
        
        // Get level name
        function getLevelName(levelCode) {
            const levels = {
                'maternal': 'Maternal',
                'preescolar': 'Preescolar',
                '1-3': '1¬∞-3¬∞ Primaria',
                '4-6': '4¬∞-6¬∞ Primaria',
                '7-9': '7¬∞-9¬∞ Secundaria'
            };
            return levels[levelCode] || levelCode;
        }
        
        // Get status badge
        function getStatusBadge(status) {
            const badges = {
                'active': '<span class="badge badge-success">Activo</span>',
                'needs_attention': '<span class="badge badge-warning">Requiere atenci√≥n</span>',
                'warning': '<span class="badge badge-danger">En riesgo</span>',
                'inactive': '<span class="badge badge-info">Inactivo</span>'
            };
            return badges[status] || '<span class="badge">Desconocido</span>';
        }
        
        // Add new student
        function addStudent(event) {
            event.preventDefault();
            
            const student = {
                id: document.getElementById('studentId').value,
                name: document.getElementById('studentName').value,
                level: document.getElementById('studentLevel').value,
                age: parseInt(document.getElementById('studentAge').value),
                email: document.getElementById('studentEmail').value,
                phone: document.getElementById('studentPhone').value,
                notes: document.getElementById('studentNotes').value,
                progress: 0,
                portfolio: false,
                status: 'active',
                techAreas: getDefaultTechAreas(document.getElementById('studentLevel').value),
                pnftLevel: getPNFTLevel(document.getElementById('studentLevel').value),
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            };
            
            const students = getStudents();
            students.push(student);
            saveStudents(students);
            
            closeModal('addStudentModal');
            document.getElementById('addStudentForm').reset();
            
            showNotification('‚úÖ Estudiante agregado exitosamente', 'success');
        }
        
        // Get default tech areas based on level
        function getDefaultTechAreas(level) {
            const areaMap = {
                'maternal': ['Apropiaci√≥n'],
                'preescolar': ['Apropiaci√≥n', 'Programaci√≥n'],
                '1-3': ['Programaci√≥n', 'Rob√≥tica'],
                '4-6': ['Rob√≥tica', 'Ciencia de Datos'],
                '7-9': ['Ciencia de Datos', 'Apropiaci√≥n']
            };
            return areaMap[level] || ['Apropiaci√≥n'];
        }
        
        // Get PNFT level based on student level
        function getPNFTLevel(level) {
            const pnftMap = {
                'maternal': 'Maternal - Nivel 0',
                'preescolar': 'Preescolar - Nivel 1',
                '1-3': 'I Ciclo - Nivel 2',
                '4-6': 'II Ciclo - Nivel 3',
                '7-9': 'III Ciclo - Nivel 4'
            };
            return pnftMap[level] || 'Nivel no definido';
        }
        
        // Edit student
        function editStudent(studentId) {
            const students = getStudents();
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                document.getElementById('studentId').value = student.id;
                document.getElementById('studentName').value = student.name;
                document.getElementById('studentLevel').value = student.level;
                document.getElementById('studentAge').value = student.age;
                document.getElementById('studentEmail').value = student.email || '';
                document.getElementById('studentPhone').value = student.phone || '';
                document.getElementById('studentNotes').value = student.notes || '';
                
                document.getElementById('addStudentForm').onsubmit = function(e) {
                    e.preventDefault();
                    
                    student.name = document.getElementById('studentName').value;
                    student.level = document.getElementById('studentLevel').value;
                    student.age = parseInt(document.getElementById('studentAge').value);
                    student.email = document.getElementById('studentEmail').value;
                    student.phone = document.getElementById('studentPhone').value;
                    student.notes = document.getElementById('studentNotes').value;
                    student.techAreas = getDefaultTechAreas(student.level);
                    student.pnftLevel = getPNFTLevel(student.level);
                    student.lastUpdated = new Date().toISOString();
                    
                    saveStudents(students);
                    closeModal('addStudentModal');
                    showNotification('‚úÖ Estudiante actualizado exitosamente', 'success');
                };
                
                document.getElementById('addStudentModal').querySelector('h2').textContent = '‚úèÔ∏è Editar Estudiante';
                showModal('addStudentModal');
            }
        }
        
        // Delete student
        function deleteStudent(studentId) {
            if (confirm('¬øEst√° seguro de eliminar este estudiante? Esta acci√≥n no se puede deshacer.')) {
                let students = getStudents();
                students = students.filter(s => s.id !== studentId);
                saveStudents(students);
                showNotification('üóëÔ∏è Estudiante eliminado exitosamente', 'warning');
            }
        }
        
        // Search students
        function searchStudents() {
            const searchTerm = document.getElementById('searchStudents').value.toLowerCase();
            const students = getStudents();
            
            const filtered = students.filter(student => 
                student.name.toLowerCase().includes(searchTerm) || 
                student.id.toLowerCase().includes(searchTerm) ||
                student.email?.toLowerCase().includes(searchTerm)
            );
            
            renderStudentsTable(filtered);
        }
        
        // Filter students by level
        function filterStudents() {
            const level = document.getElementById('filterLevel').value;
            const students = getStudents();
            
            if (!level) {
                renderStudentsTable(students);
                return;
            }
            
            const filtered = students.filter(student => student.level === level);
            renderStudentsTable(filtered);
        }
        
        // View student portfolio
        function viewPortfolio(studentId) {
            const students = getStudents();
            const student = students.find(s => s.id === studentId);
            
            if (!student) return;
            
            document.getElementById('portfolioTitle').textContent = `Portafolio Digital - ${student.name}`;
            
            // Generate portfolio content based on level
            const portfolioContent = generatePortfolioContent(student);
            document.getElementById('portfolioContent').innerHTML = portfolioContent;
            
            showModal('portfolioModal');
        }
        
        // Generate portfolio content
        function generatePortfolioContent(student) {
            const levelResources = {
                'maternal': [
                    'Interacci√≥n con tabletas educativas',
                    'Reconocimiento de colores y formas digitales',
                    'Actividades t√°ctiles b√°sicas',
                    'Manipulaci√≥n de objetos tecnol√≥gicos seguros'
                ],
                'preescolar': [
                    'Proyectos en Scratch Jr.',
                    'Introducci√≥n a la rob√≥tica con Bee-Bot',
                    'Actividades de pensamiento computacional',
                    'Uso b√°sico de herramientas digitales'
                ],
                '1-3': [
                    'Proyectos Scratch avanzados',
                    'Dise√±o 2D b√°sico con herramientas digitales',
                    'Circuitos simples con materiales reciclados',
                    'Introducci√≥n a conceptos de programaci√≥n'
                ],
                '4-6': [
                    'Programaci√≥n en Python b√°sico',
                    'Dise√±o 3D con Tinkercad',
                    'Rob√≥tica con Arduino b√°sico',
                    'Desarrollo web con HTML/CSS simple',
                    'Introducci√≥n a an√°lisis de datos'
                ],
                '7-9': [
                    'Desarrollo de aplicaciones m√≥viles b√°sicas',
                    'Inteligencia Artificial con Teachable Machine',
                    'Proyectos IoT simples',
                    'An√°lisis de datos con Python',
                    'Dise√±o de sistemas automatizados'
                ]
            };
            
            return `
                <div class="form-grid">
                    <div>
                        <h4 style="margin-bottom: 10px; color: var(--dark);">Informaci√≥n del Estudiante</h4>
                        <p><strong>ID:</strong> ${student.id}</p>
                        <p><strong>Nivel:</strong> ${getLevelName(student.level)}</p>
                        <p><strong>Nivel PNFT:</strong> ${student.pnftLevel}</p>
                        <p><strong>Edad:</strong> ${student.age} a√±os</p>
                        <p><strong>Progreso:</strong> ${student.progress}%</p>
                        <p><strong>√Åreas Tecnol√≥gicas:</strong> ${student.techAreas?.join(', ') || 'No asignadas'}</p>
                        
                        <h4 style="margin-top: 20px; margin-bottom: 10px; color: var(--dark);">Recursos Recomendados PNFT</h4>
                        <ul style="padding-left: 20px; color: var(--gray); font-size: 13px;">
                            ${levelResources[student.level]?.map(item => `<li>${item}</li>`).join('') || '<li>No hay recursos espec√≠ficos</li>'}
                        </ul>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 10px; color: var(--dark);">Proyectos Tecnol√≥gicos</h4>
                        <div style="background: var(--light); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                            <strong>üõ†Ô∏è Proyecto Actual:</strong> ${getCurrentProject(student.level)}
                            <p style="margin-top: 10px; font-size: 13px; color: var(--gray);">
                                ${getProjectDescription(student.level)}
                            </p>
                        </div>
                        
                        <h4 style="margin-bottom: 10px; color: var(--dark);">An√°lisis de Competencias PNFT</h4>
                        <div style="background: var(--light); padding: 15px; border-radius: 10px;">
                            ${generatePNFTCompetencyAnalysis(student)}
                        </div>
                        
                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="exportPortfolio('${student.id}')">
                                üì§ Exportar Portafolio PDF
                            </button>
                            <button class="btn btn-secondary" onclick="generateActivityPlan('${student.id}')">
                                üìù Plan de Actividades
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Get current project based on level
        function getCurrentProject(level) {
            const projects = {
                'maternal': 'Juego de reconocimiento de formas y colores digitales',
                'preescolar': 'Animaci√≥n interactiva en Scratch Jr. sobre cuentos',
                '1-3': 'Videojuego educativo en Scratch sobre matem√°ticas',
                '4-6': 'Sistema automatizado con Arduino para control ambiental',
                '7-9': 'Aplicaci√≥n web con inteligencia artificial para clasificaci√≥n de im√°genes'
            };
            return projects[level] || 'Proyecto tecnol√≥gico personalizado';
        }
        
        // Get project description
        function getProjectDescription(level) {
            const descriptions = {
                'maternal': 'Proyecto de acercamiento inicial a la tecnolog√≠a mediante juegos interactivos simples.',
                'preescolar': 'Desarrollo de historias interactivas que fomentan el pensamiento computacional.',
                '1-3': 'Creaci√≥n de videojuegos educativos que desarrollan habilidades de programaci√≥n por bloques.',
                '4-6': 'Implementaci√≥n de sistemas automatizados que integran programaci√≥n y electr√≥nica.',
                '7-9': 'Desarrollo de soluciones tecnol√≥gicas complejas integrando m√∫ltiples √°reas del conocimiento.'
            };
            return descriptions[level] || 'Proyecto tecnol√≥gico adaptado al nivel del estudiante.';
        }
        
        // Generate PNFT competency analysis
        function generatePNFTCompetencyAnalysis(student) {
            const competencies = getPNFTCompetencies(student.level);
            
            let html = '';
            for (const competency of competencies) {
                const value = calculateCompetencyValue(student, competency);
                html += `
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-size: 13px;">${competency.name}</span>
                            <span style="font-weight: 600; font-size: 13px;">${value}%</span>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" style="width: ${value}%;"></div>
                        </div>
                    </div>
                `;
            }
            return html;
        }
        
        // Get PNFT competencies by level
        function getPNFTCompetencies(level) {
            const competencies = {
                'maternal': [
                    { name: 'Reconocimiento tecnol√≥gico', weight: 0.3 },
                    { name: 'Interacci√≥n b√°sica', weight: 0.4 },
                    { name: 'Curiosidad digital', weight: 0.3 }
                ],
                'preescolar': [
                    { name: 'Uso de herramientas digitales', weight: 0.25 },
                    { name: 'Pensamiento algor√≠tmico', weight: 0.25 },
                    { name: 'Creaci√≥n digital b√°sica', weight: 0.25 },
                    { name: 'Colaboraci√≥n tecnol√≥gica', weight: 0.25 }
                ],
                '1-3': [
                    { name: 'Programaci√≥n por bloques', weight: 0.3 },
                    { name: 'Dise√±o digital', weight: 0.2 },
                    { name: 'Resoluci√≥n de problemas', weight: 0.3 },
                    { name: 'Comunicaci√≥n digital', weight: 0.2 }
                ],
                '4-6': [
                    { name: 'Programaci√≥n textual', weight: 0.25 },
                    { name: 'Dise√±o 3D', weight: 0.2 },
                    { name: 'Rob√≥tica b√°sica', weight: 0.25 },
                    { name: 'An√°lisis de datos simple', weight: 0.15 },
                    { name: 'Proyectos colaborativos', weight: 0.15 }
                ],
                '7-9': [
                    { name: 'Desarrollo de software', weight: 0.2 },
                    { name: 'Inteligencia Artificial', weight: 0.2 },
                    { name: 'Internet de las Cosas', weight: 0.2 },
                    { name: 'An√°lisis de datos avanzado', weight: 0.2 },
                    { name: 'Innovaci√≥n tecnol√≥gica', weight: 0.2 }
                ]
            };
            return competencies[level] || [{ name: 'Competencias generales', weight: 1 }];
        }
        
        // Calculate competency value
        function calculateCompetencyValue(student, competency) {
            // Base value from student progress plus some variation
            const base = student.progress || 0;
            const variation = Math.random() * 20 - 10; // -10 to +10
            return Math.max(0, Math.min(100, Math.round(base + variation)));
        }
        
        // Generate all portfolios
        function generateAllPortfolios() {
            showNotification('üöÄ Generando portafolios digitales para todos los estudiantes...', 'info');
            
            // Simulate portfolio generation
            setTimeout(() => {
                const students = getStudents();
                students.forEach(student => {
                    if (!student.portfolio) {
                        student.portfolio = true;
                        student.lastUpdated = new Date().toISOString();
                    }
                });
                saveStudents(students);
                showNotification('‚úÖ Portafolios digitales generados exitosamente', 'success');
            }, 2000);
        }
        
        // Export portfolio as PDF
        function exportPortfolio(studentId) {
            showNotification('üì§ Preparando exportaci√≥n del portafolio en formato PDF MEP...', 'info');
            // In a real implementation, this would generate and download a PDF
            setTimeout(() => {
                showNotification('‚úÖ Portafolio exportado en formato PDF', 'success');
            }, 1500);
        }
        
        // Generate activity plan
        function generateActivityPlan(studentId) {
            const students = getStudents();
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                const plan = `Plan de actividades tecnol√≥gicas para ${student.name} (${getLevelName(student.level)})
                
                üìã ACTIVIDADES SEMANALES:
                1. Ejercicio de programaci√≥n b√°sica (30 min)
                2. Proyecto pr√°ctico de tecnolog√≠a (45 min)
                3. Revisi√≥n de portafolio digital (20 min)
                4. Actividad colaborativa (40 min)
                
                üéØ OBJETIVOS:
                ‚Ä¢ Mejorar competencia en ${student.techAreas?.[0] || 'tecnolog√≠a'}
                ‚Ä¢ Completar proyecto principal
                ‚Ä¢ Desarrollar pensamiento computacional
                
                üìÖ DURACI√ìN: 4 semanas
                üìä EVALUACI√ìN: Seguimiento continuo mediante portafolio`;
                
                alert(plan);
            }
        }
        
        // Generate AI recommendations
        function generateAIRecommendations(students) {
            const atRisk = students.filter(s => s.status === 'needs_attention' || s.status === 'warning');
            const lowProgress = students.filter(s => s.progress < 50);
            const noPortfolio = students.filter(s => !s.portfolio);
            
            let recommendations = '';
            
            if (atRisk.length > 0) {
                recommendations += `<p>‚ö†Ô∏è <strong>${atRisk.length} estudiantes requieren atenci√≥n inmediata</strong>. Revise sus portafolios para intervenci√≥n pedag√≥gica seg√∫n PNFT.</p>`;
            }
            
            if (lowProgress.length > 0) {
                recommendations += `<p>üìâ <strong>${lowProgress.length} estudiantes con progreso bajo (<50%)</strong>. Considere actividades diferenciadas en las √°reas tecnol√≥gicas correspondientes.</p>`;
            }
            
            if (noPortfolio.length > 0) {
                recommendations += `<p>üìÅ <strong>${noPortfolio.length} estudiantes sin portafolio digital</strong>. Genere portafolios para seguimiento completo seg√∫n est√°ndares MEP.</p>`;
            }
            
            if (!recommendations) {
                recommendations = '<p>‚úÖ Todos los estudiantes est√°n progresando adecuadamente seg√∫n est√°ndares PNFT. Contin√∫e con el plan actual.</p>';
            }
            
            // Add personalized recommendations based on PNFT
            recommendations += `<p style="margin-top: 15px;"><strong>üéØ Recomendaci√≥n PNFT:</strong> ${getPNFTRecommendation(students)}</p>`;
            
            document.getElementById('aiRecommendations').innerHTML = recommendations;
        }
        
        // Get PNFT recommendation
        function getPNFTRecommendation(students) {
            const levels = students.map(s => s.level);
            const uniqueLevels = [...new Set(levels)];
            
            if (uniqueLevels.length === 1) {
                return `Grupo homog√©neo de ${getLevelName(uniqueLevels[0])}. Implemente proyectos colaborativos seg√∫n PNFT nivel ${getPNFTLevelNumber(uniqueLevels[0])}.`;
            }
            
            const techAreaCount = {};
            students.forEach(student => {
                student.techAreas?.forEach(area => {
                    techAreaCount[area] = (techAreaCount[area] || 0) + 1;
                });
            });
            
            const mostCommonArea = Object.keys(techAreaCount).reduce((a, b) => 
                techAreaCount[a] > techAreaCount[b] ? a : b, 'Apropiaci√≥n');
            
            return `Grupo multinivel detectado. Implemente aprendizaje diferenciado por estaciones tecnol√≥gicas, enfocado en ${mostCommonArea}.`;
        }
        
        // Get PNFT level number
        function getPNFTLevelNumber(level) {
            const levelMap = {
                'maternal': 0,
                'preescolar': 1,
                '1-3': 2,
                '4-6': 3,
                '7-9': 4
            };
            return levelMap[level] || 0;
        }
        
        // Export data to CSV
        function exportData() {
            const students = getStudents();
            const headers = ['ID', 'Nombre', 'Nivel', 'PNFT_Nivel', 'Edad', 'Email', 'Progreso', 'Estado', 'Areas_Tecnologicas'];
            const csv = [
                headers.join(','),
                ...students.map(s => [
                    s.id,
                    `"${s.name}"`,
                    s.level,
                    s.pnftLevel,
                    s.age,
                    s.email || '',
                    s.progress,
                    s.status,
                    `"${s.techAreas?.join(';') || ''}"`
                ].join(','))
            ].join('\n');
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `estudiantes_tecnologia_mep_${new Date().toISOString().slice(0,10)}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('üì§ Datos exportados en formato CSV MEP', 'success');
        }
        
        // Import CSV data
        function importCSV() {
            const csvData = document.getElementById('csvData').value;
            
            if (!csvData.trim()) {
                showNotification('‚ùå Ingrese datos CSV para importar', 'error');
                return;
            }
            
            try {
                const lines = csvData.split('\n').filter(line => line.trim());
                const headers = lines[0].split(',').map(h => h.trim());
                
                const newStudents = [];
                
                for (let i = 1; i < lines.length; i++) {
                    const values = lines[i].split(',').map(v => v.trim().replace(/^"|"$/g, ''));
                    const level = values[3]?.toLowerCase() || '1-3';
                    
                    const student = {
                        id: values[0] || `IMP${Date.now()}${i}`,
                        name: values[1] || 'Estudiante Importado',
                        level: level,
                        age: parseInt(values[4]) || 8,
                        email: values[5] || '',
                        progress: 0,
                        portfolio: false,
                        status: 'active',
                        techAreas: getDefaultTechAreas(level),
                        pnftLevel: getPNFTLevel(level),
                        imported: true,
                        createdAt: new Date().toISOString()
                    };
                    newStudents.push(student);
                }
                
                const existingStudents = getStudents();
                const allStudents = [...existingStudents, ...newStudents];
                saveStudents(allStudents);
                
                closeModal('importModal');
                showNotification(`‚úÖ ${newStudents.length} estudiantes importados exitosamente seg√∫n formato MEP`, 'success');
                document.getElementById('csvData').value = '';
                
            } catch (error) {
                showNotification('‚ùå Error al importar datos CSV. Verifique el formato MEP.', 'error');
                console.error('Import error:', error);
            }
        }
        
        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.getElementById('addStudentForm').onsubmit = addStudent;
            document.getElementById('addStudentForm').reset();
            document.getElementById('addStudentModal').querySelector('h2').textContent = 'üë®‚Äçüéì Agregar Nuevo Estudiante';
        }
        
        // Show notification
        function showNotification(message, type = 'info') {
            // Remove existing notification
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                background: ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--danger)' : 'var(--primary)'};
                color: white;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: slideIn 0.3s ease;
                font-weight: 500;
            `;
            
            notification.innerHTML = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
            
            // Add animation styles
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // Switch between tabs
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            // Load tab-specific content
            if (tabName === 'portfolios') {
                loadPortfoliosContent();
            } else if (tabName === 'analytics') {
                loadAnalyticsContent();
            }
        }
        
        // Load portfolios content
        function loadPortfoliosContent() {
            const students = getStudents();
            const container = document.getElementById('portfoliosContainer');
            
            let html = '<div class="dashboard-grid">';
            
            students.forEach(student => {
                const progressColor = student.progress >= 70 ? 'success' : 
                                     student.progress >= 40 ? 'warning' : 'danger';
                
                html += `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">${student.name}</div>
                            <div class="card-icon icon-${progressColor}">üìÅ</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 14px; color: var(--gray);">Progreso:</span>
                                <span style="font-weight: 600; color: var(--${progressColor});">${student.progress}%</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar" style="width: ${student.progress}%; background: var(--${progressColor});"></div>
                            </div>
                        </div>
                        <div style="font-size: 13px; color: var(--gray); margin-bottom: 15px;">
                            <strong>Nivel PNFT:</strong> ${student.pnftLevel}<br>
                            <strong>√Åreas:</strong> ${student.techAreas?.slice(0,2).join(', ')}
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary btn-sm" onclick="viewPortfolio('${student.id}')" style="flex: 1;">
                                Ver Portafolio
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="exportPortfolio('${student.id}')">
                                üì§
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        // Load analytics content
        function loadAnalyticsContent() {
            const students = getStudents();
            
            // Performance prediction
            let predictionHTML = '<div style="font-size: 14px;">';
            
            const highPerformers = students.filter(s => s.progress >= 80);
            const mediumPerformers = students.filter(s => s.progress >= 50 && s.progress < 80);
            const lowPerformers = students.filter(s => s.progress < 50);
            
            if (highPerformers.length > 0) {
                predictionHTML += `<p>üèÜ <strong>${highPerformers.length} estudiantes de alto desempe√±o</strong>: Podr√≠an liderar proyectos avanzados seg√∫n PNFT.</p>`;
            }
            
            if (mediumPerformers.length > 0) {
                predictionHTML += `<p>üìà <strong>${mediumPerformers.length} estudiantes con desempe√±o medio</strong>: Con apoyo adecuado, pueden alcanzar nivel alto en tecnolog√≠a.</p>`;
            }
            
            if (lowPerformers.length > 0) {
                predictionHTML += `<p>üìä <strong>${lowPerformers.length} estudiantes con bajo desempe√±o</strong>: Requieren intervenci√≥n diferenciada en √°reas tecnol√≥gicas espec√≠ficas.</p>`;
            }
            
            // Add PNFT analysis
            const techAreaDistribution = {};
            students.forEach(student => {
                student.techAreas?.forEach(area => {
                    techAreaDistribution[area] = (techAreaDistribution[area] || 0) + 1;
                });
            });
            
            if (Object.keys(techAreaDistribution).length > 0) {
                predictionHTML += '<p style="margin-top: 15px;"><strong>üìä Distribuci√≥n por √Årea PNFT:</strong></p>';
                for (const [area, count] of Object.entries(techAreaDistribution)) {
                    const percentage = Math.round((count / students.length) * 100);
                    predictionHTML += `<p>‚Ä¢ ${area}: ${count} estudiantes (${percentage}%)</p>`;
                }
            }
            
            predictionHTML += '</div>';
            document.getElementById('performancePrediction').innerHTML = predictionHTML;
            
            // Early alerts
            let alertsHTML = '<div style="font-size: 14px;">';
            
            const riskStudents = students.filter(s => s.status === 'needs_attention' || s.status === 'warning');
            
            if (riskStudents.length > 0) {
                alertsHTML += '<div style="background: rgba(239, 68, 68, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">';
                alertsHTML += '<strong>‚ö†Ô∏è ALERTAS TEMPRANAS PNFT</strong><br>';
                riskStudents.slice(0, 3).forEach(student => {
                    alertsHTML += `<div style="margin-top: 10px;">
                        <strong>${student.name}</strong> (${getLevelName(student.level)})<br>
                        <span style="font-size: 12px; color: var(--danger);">Progreso: ${student.progress}% - √Åreas: ${student.techAreas?.join(', ') || 'No definidas'}</span>
                    </div>`;
                });
                alertsHTML += '</div>';
            } else {
                alertsHTML += '<p style="color: var(--success);">‚úÖ No hay alertas activas. Todos los estudiantes progresan adecuadamente seg√∫n est√°ndares PNFT.</p>';
            }
            
            // Add recommendations
            alertsHTML += '<div style="background: rgba(37, 99, 235, 0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">';
            alertsHTML += '<strong>üéØ Recomendaciones de Intervenci√≥n:</strong><br>';
            alertsHTML += '<ul style="padding-left: 20px; margin-top: 10px; font-size: 13px;">';
            alertsHTML += '<li>Implementar proyectos colaborativos por √°reas tecnol√≥gicas</li>';
            alertsHTML += '<li>Realizar evaluaciones diagn√≥sticas seg√∫n PNFT</li>';
            alertsHTML += '<li>Diversificar estrategias seg√∫n nivel tecnol√≥gico</li>';
            alertsHTML += '<li>Integrar herramientas tecnol√≥gicas espec√≠ficas por √°rea</li>';
            alertsHTML += '</ul>';
            alertsHTML += '</div>';
            
            alertsHTML += '</div>';
            document.getElementById('earlyAlerts').innerHTML = alertsHTML;
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeDatabase();
            updateDashboard();
            renderStudentsTable();
            
            // Setup modal triggers
            window.showAddStudentModal = () => showModal('addStudentModal');
            window.showImportModal = () => showModal('importModal');
            
            // Setup file input
            document.getElementById('csvFile').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        document.getElementById('csvData').value = event.target.result;
                    };
                    reader.readAsText(file);
                }
            });
            
            // Add sample data button for testing
            const header = document.querySelector('.page-header');
            const testBtn = document.createElement('button');
            testBtn.className = 'btn btn-secondary';
            testBtn.innerHTML = 'üß™ Cargar datos de prueba PNFT';
            testBtn.onclick = function() {
                localStorage.removeItem(DB_NAME);
                initializeDatabase();
                updateDashboard();
                renderStudentsTable();
                showNotification('üß™ Datos de prueba PNFT cargados exitosamente', 'success');
            };
            header.appendChild(testBtn);
        });
    </script>
</body>
</html>
