<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TECNO-PIA | Principal - Sistema Unificado EXCEVAL + Califica.ai</title>
    
    <!-- ESTILOS GLASSMORPHISM COMPLETOS EMBEBIDOS -->
    <style>
        /* ===== SISTEMA DE DISEÑO COMPLETO ===== */
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #2ed573;
            --warning: #ffa502;
            --danger: #ff4757;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --glass-light: rgba(255, 255, 255, 0.15);
            --glass-dark: rgba(0, 0, 0, 0.1);
            --shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            --border: rgba(255, 255, 255, 0.2);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-success: linear-gradient(135deg, #2ed573 0%, #1dd1a1 100%);
            --gradient-warning: linear-gradient(135deg, #ffa502 0%, #ff7f50 100%);
            --gradient-danger: linear-gradient(135deg, #ff4757 0%, #ff3838 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Poppins', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: var(--text-primary);
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(118, 75, 162, 0.1) 0%, transparent 50%);
            z-index: -1;
        }

        /* ===== CONTENEDOR PRINCIPAL ===== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        /* ===== HEADER PRINCIPAL ===== */
        .main-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: var(--glass-light);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .main-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .logo-text h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #fff 0%, rgba(255, 255, 255, 0.8) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .logo-text p {
            font-size: 14px;
            color: var(--text-secondary);
            opacity: 0.9;
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        /* ===== BOTONES SISTEMA ===== */
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
        }

        .btn-success {
            background: var(--gradient-success);
            color: white;
            box-shadow: 0 8px 25px rgba(46, 213, 115, 0.3);
        }

        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(46, 213, 115, 0.5);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }

        .btn-sm {
            padding: 10px 20px;
            font-size: 14px;
        }

        /* ===== SIDEBAR DE NAVEGACIÓN ===== */
        .nav-sidebar {
            width: 280px;
            background: var(--glass-light);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid var(--border);
            padding: 25px;
            position: fixed;
            left: 20px;
            top: 140px;
            height: calc(100vh - 180px);
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .nav-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 20px;
            padding-left: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .nav-item {
            padding: 16px 20px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: white;
            transform: translateX(5px);
        }

        .nav-item.active {
            background: rgba(102, 126, 234, 0.15);
            color: white;
        }

        .nav-item.active::before {
            transform: scaleY(1);
        }

        .nav-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .nav-text {
            font-size: 15px;
            font-weight: 500;
        }

        .nav-badge {
            margin-left: auto;
            background: var(--primary);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        /* ===== CONTENIDO PRINCIPAL ===== */
        .main-content {
            margin-left: 320px;
            padding: 20px;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        /* ===== TARJETAS DEL SISTEMA ===== */
        .card {
            background: var(--glass-light);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .card-header {
            padding: 25px 30px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .card-title h3 {
            font-size: 20px;
            font-weight: 600;
            background: linear-gradient(135deg, #fff 0%, rgba(255, 255, 255, 0.8) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .card-body {
            padding: 30px;
        }

        .card-full-width {
            grid-column: 1 / -1;
        }

        /* ===== FORMULARIOS ===== */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-control {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: white;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
            background: rgba(255, 255, 255, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* ===== GRID DE NIVELES ===== */
        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .level-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .level-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .level-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
        }

        .level-card.active {
            background: rgba(102, 126, 234, 0.15);
            border-color: var(--primary);
        }

        .level-card.active::before {
            transform: scaleX(1);
        }

        .level-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 15px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: var(--gradient-primary);
            color: white;
        }

        .level-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
            color: white;
        }

        .level-age {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* ===== PORCENTAJES MEP ===== */
        .percentages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .percentage-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .percentage-item:hover {
            border-color: var(--border);
            transform: translateY(-3px);
        }

        .percentage-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .percentage-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .percentage-input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.07);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: white;
            text-align: center;
            font-size: 18px;
            font-weight: 600;
        }

        /* ===== ESTADÍSTICAS INTELIGENTES ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: var(--glass-light);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .stat-value {
            font-size: 42px;
            font-weight: 700;
            margin: 15px 0;
            background: linear-gradient(135deg, #fff 0%, rgba(255, 255, 255, 0.8) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-trend {
            font-size: 13px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        /* ===== ANÁLISIS INTELIGENTE (Califica.ai) ===== */
        .analysis-section {
            margin-top: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .analysis-title {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .analysis-title h4 {
            font-size: 20px;
            font-weight: 600;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .ai-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: var(--gradient-success);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .recommendation-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 25px;
            border-left: 4px solid var(--success);
            transition: all 0.3s ease;
        }

        .recommendation-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(5px);
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .rec-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: rgba(46, 213, 115, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--success);
            font-size: 18px;
        }

        .rec-title {
            font-weight: 600;
            font-size: 16px;
            color: white;
        }

        .rec-description {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .rec-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* ===== NOTIFICACIONES ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px 25px;
            border-radius: 16px;
            color: white;
            font-weight: 500;
            box-shadow: var(--shadow);
            animation: slideIn 0.3s ease-out;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 15px;
            max-width: 400px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
        }

        .notification.success {
            background: rgba(46, 213, 115, 0.15);
            border-left: 4px solid var(--success);
        }

        .notification.error {
            background: rgba(255, 71, 87, 0.15);
            border-left: 4px solid var(--danger);
        }

        .notification.info {
            background: rgba(30, 144, 255, 0.15);
            border-left: 4px solid #1e90ff;
        }

        .notification-icon {
            font-size: 22px;
        }

        .notification-close {
            margin-left: auto;
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .notification-close:hover {
            opacity: 1;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 1200px) {
            .nav-sidebar {
                position: relative;
                width: 100%;
                height: auto;
                margin-bottom: 20px;
                left: 0;
                top: 0;
            }
            
            .main-content {
                margin-left: 0;
            }
        }

        @media (max-width: 768px) {
            .main-header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .levels-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }

        /* ===== ANIMACIONES ===== */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== SCROLLBAR PERSONALIZADA ===== */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient-primary);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>

    <!-- FONT AWESOME EMBEBIDO (solo los iconos necesarios) -->
    <style>
        @font-face {
            font-family: 'Font Awesome 6 Free';
            font-style: normal;
            font-weight: 900;
            font-display: block;
            src: url("data:font/woff2;charset=utf-8;base64,d09GMgABAAAAA...") format('woff2');
        }
        
        .fa {
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased;
            display: inline-block;
            font-style: normal;
            font-variant: normal;
            line-height: 1;
            text-rendering: auto;
        }
        
        .fa-cog:before { content: "\f013"; }
        .fa-users:before { content: "\f0c0"; }
        .fa-list-check:before { content: "\f0ae"; }
        .fa-calendar-day:before { content: "\f783"; }
        .fa-tasks:before { content: "\f0ae"; }
        .fa-project-diagram:before { content: "\f542"; }
        .fa-file-alt:before { content: "\f15c"; }
        .fa-clipboard-check:before { content: "\f46c"; }
        .fa-chart-bar:before { content: "\f080"; }
        .fa-toolbox:before { content: "\f552"; }
        .fa-robot:before { content: "\f544"; }
        .fa-school:before { content: "\f549"; }
        .fa-user-tie:before { content: "\f508"; }
        .fa-calendar-alt:before { content: "\f073"; }
        .fa-graduation-cap:before { content: "\f19d"; }
        .fa-percentage:before { content: "\f541"; }
        .fa-balance-scale:before { content: "\f24e"; }
        .fa-chart-pie:before { content: "\f200"; }
        .fa-rocket:before { content: "\f135"; }
        .fa-save:before { content: "\f0c7"; }
        .fa-undo:before { content: "\f0e2"; }
        .fa-info-circle:before { content: "\f05a"; }
        .fa-lightbulb:before { content: "\f0eb"; }
        .fa-bell:before { content: "\f0f3"; }
        .fa-user-circle:before { content: "\f2bd"; }
        .fa-chevron-right:before { content: "\f054"; }
        .fa-check-circle:before { content: "\f058"; }
        .fa-exclamation-circle:before { content: "\f06a"; }
        .fa-times-circle:before { content: "\f057"; }
        .fa-search:before { content: "\f002"; }
        .fa-filter:before { content: "\f0b0"; }
        .fa-sort-amount-down:before { content: "\f160"; }
        .fa-eraser:before { content: "\f12d"; }
        .fa-database:before { content: "\f1c0"; }
        .fa-cloud-download-alt:before { content: "\f381"; }
        .fa-brain:before { content: "\f5dc"; }
        .fa-bolt:before { content: "\f0e7"; }
        .fa-shield-alt:before { content: "\f3ed"; }
        .fa-comments:before { content: "\f086"; }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER PRINCIPAL -->
        <header class="main-header fade-in">
            <div class="logo-section">
                <div class="logo-icon">
                    <i class="fa fa-robot"></i>
                </div>
                <div class="logo-text">
                    <h1>TECNO-PIA</h1>
                    <p>Sistema Unificado EXCEVAL + Califica.ai | Formación Tecnológica</p>
                </div>
            </div>
            
            <div class="header-actions">
                <button class="btn btn-success" onclick="guardarConfiguracion()">
                    <i class="fa fa-save"></i> Guardar Sistema
                </button>
                <button class="btn btn-primary" onclick="exportarConfiguracion()">
                    <i class="fa fa-database"></i> Exportar MEP
                </button>
                <button class="btn btn-secondary" onclick="analizarRecomendaciones()">
                    <i class="fa fa-brain"></i> Análisis IA
                </button>
            </div>
        </header>

        <!-- SIDEBAR DE NAVEGACIÓN -->
        <nav class="nav-sidebar slide-up">
            <div class="nav-title">Módulos del Sistema</div>
            <div class="nav-menu">
                <a href="principal.html" class="nav-item active">
                    <i class="nav-icon fa fa-cog"></i>
                    <span class="nav-text">Principal</span>
                    <span class="nav-badge">Activo</span>
                </a>
                <a href="estudiantes.html" class="nav-item" onclick="cargarModulo('estudiantes')">
                    <i class="nav-icon fa fa-users"></i>
                    <span class="nav-text">Estudiantes</span>
                    <span class="nav-badge" id="badgeEstudiantes">0</span>
                </a>
                <a href="indicadores.html" class="nav-item" onclick="cargarModulo('indicadores')">
                    <i class="nav-icon fa fa-list-check"></i>
                    <span class="nav-text">Indicadores PNFT</span>
                    <span class="nav-badge" id="badgeIndicadores">15+</span>
                </a>
                <a href="cotidiano.html" class="nav-item" onclick="cargarModulo('cotidiano')">
                    <i class="nav-icon fa fa-calendar-day"></i>
                    <span class="nav-text">Evaluación Cotidiana</span>
                </a>
                <a href="tareas.html" class="nav-item" onclick="cargarModulo('tareas')">
                    <i class="nav-icon fa fa-tasks"></i>
                    <span class="nav-text">Tareas Tecnológicas</span>
                </a>
                <a href="proyectos.html" class="nav-item" onclick="cargarModulo('proyectos')">
                    <i class="nav-icon fa fa-project-diagram"></i>
                    <span class="nav-text">Proyectos Tech</span>
                </a>
                <a href="pruebas.html" class="nav-item" onclick="cargarModulo('pruebas')">
                    <i class="nav-icon fa fa-file-alt"></i>
                    <span class="nav-text">Pruebas</span>
                </a>
                <a href="asistencia.html" class="nav-item" onclick="cargarModulo('asistencia')">
                    <i class="nav-icon fa fa-clipboard-check"></i>
                    <span class="nav-text">Asistencia</span>
                </a>
                <a href="reportes.html" class="nav-item" onclick="cargarModulo('reportes')">
                    <i class="nav-icon fa fa-chart-bar"></i>
                    <span class="nav-text">Reportes Inteligentes</span>
                </a>
                <a href="recursos.html" class="nav-item" onclick="cargarModulo('recursos')">
                    <i class="nav-icon fa fa-toolbox"></i>
                    <span class="nav-text">Recursos Tech</span>
                </a>
            </div>
            
            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border);">
                <div class="nav-title">Análisis en Tiempo Real</div>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 12px;">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">Estado del Sistema</div>
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #2ed573;"></div>
                        <div style="font-size: 13px;">Base de datos: <strong id="statusDB">Cargada</strong></div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #2ed573;"></div>
                        <div style="font-size: 13px;">Configuración: <strong id="statusConfig">Completa</strong></div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- CONTENIDO PRINCIPAL -->
        <main class="main-content">
            <!-- SECCIÓN 1: INFORMACIÓN DE LA INSTITUCIÓN -->
            <div class="content-grid">
                <div class="card card-full-width fade-in">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fa fa-school"></i>
                            </div>
                            <h3>Información de la Institución</h3>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-sm btn-secondary" onclick="cargarDatosEjemplo()">
                                <i class="fa fa-database"></i> Cargar Ejemplo
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-school"></i> Nombre de la Institución</label>
                                <input type="text" id="institucionNombre" class="form-control" 
                                       placeholder="Ej: Centro Educativo Tecnológico" value="Centro de Formación Tecnológica MEP">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-map-marker-alt"></i> Dirección</label>
                                <input type="text" id="institucionDireccion" class="form-control" 
                                       placeholder="Dirección completa de la institución">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-user-tie"></i> Nombre del Docente</label>
                                <input type="text" id="docenteNombre" class="form-control" 
                                       placeholder="Nombre completo del docente">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-id-card"></i> Cédula</label>
                                <input type="text" id="docenteCedula" class="form-control" 
                                       placeholder="Número de identificación">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-envelope"></i> Correo Electrónico</label>
                                <input type="email" id="docenteEmail" class="form-control" 
                                       placeholder="correo@institucion.ed.cr">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-phone"></i> Teléfono</label>
                                <input type="tel" id="docenteTelefono" class="form-control" 
                                       placeholder="(506) 0000-0000">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 2: CONFIGURACIÓN DEL PERÍODO -->
            <div class="content-grid">
                <div class="card fade-in">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fa fa-calendar-alt"></i>
                            </div>
                            <h3>Período Lectivo</h3>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-calendar"></i> Año Lectivo</label>
                                <select id="anioLectivo" class="form-control">
                                    <option value="2024">2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-clock"></i> Período Actual</label>
                                <select id="periodoActual" class="form-control">
                                    <option value="1">I Trimestre</option>
                                    <option value="2">II Trimestre</option>
                                    <option value="3">III Trimestre</option>
                                    <option value="final">Evaluación Final</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-play-circle"></i> Inicio del Período</label>
                                <input type="date" id="fechaInicio" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fa fa-stop-circle"></i> Fin del Período</label>
                                <input type="date" id="fechaFin" class="form-control">
                            </div>
                        </div>
                        
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 12px; margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="fa fa-info-circle" style="color: #667eea;"></i>
                                <span style="font-size: 14px; color: var(--text-secondary);">
                                    Configure las fechas según el calendario escolar MEP
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN 3: NIVELES DE FORMACIÓN TECNOLÓGICA -->
                <div class="card fade-in">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fa fa-graduation-cap"></i>
                            </div>
                            <h3>Niveles a Cargo</h3>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-sm btn-secondary" onclick="seleccionarTodosNiveles()">
                                <i class="fa fa-check-square"></i> Todos
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                            Seleccione los niveles de Formación Tecnológica que atiende:
                        </p>
                        
                        <div class="levels-grid" id="nivelesContainer">
                            <!-- Los niveles se cargarán dinámicamente -->
                        </div>
                        
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 12px; margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="fa fa-lightbulb" style="color: #ffa502;"></i>
                                <span style="font-size: 14px; color: var(--text-secondary);">
                                    La Formación Tecnológica en Costa Rica se imparte desde Maternal hasta Noveno año
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 4: PORCENTAJES DE EVALUACIÓN MEP -->
            <div class="content-grid">
                <div class="card card-full-width fade-in">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fa fa-percentage"></i>
                            </div>
                            <h3>Porcentajes de Evaluación MEP</h3>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-sm btn-primary" onclick="aplicarPorcentajesMEP()">
                                <i class="fa fa-balance-scale"></i> Estándar MEP
                            </button>
                            <button class="btn btn-sm btn-secondary" onclick="calcularPorcentajes()">
                                <i class="fa fa-calculator"></i> Calcular
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <p style="color: var(--text-secondary); margin-bottom: 25px; font-size: 14px;">
                            Configure los porcentajes según lineamientos MEP para Formación Tecnológica:
                        </p>
                        
                        <div class="percentages-grid">
                            <div class="percentage-item">
                                <div class="percentage-label">Trabajo Cotidiano</div>
                                <div class="percentage-value">30%</div>
                                <input type="number" id="porcentajeCotidiano" class="percentage-input" 
                                       min="0" max="100" value="30" onchange="actualizarTotal()">
                            </div>
                            
                            <div class="percentage-item">
                                <div class="percentage-label">Tareas Tecnológicas</div>
                                <div class="percentage-value">20%</div>
                                <input type="number" id="porcentajeTareas" class="percentage-input" 
                                       min="0" max="100" value="20" onchange="actualizarTotal()">
                            </div>
                            
                            <div class="percentage-item">
                                <div class="percentage-label">Proyectos Tech</div>
                                <div class="percentage-value">25%</div>
                                <input type="number" id="porcentajeProyectos" class="percentage-input" 
                                       min="0" max="100" value="25" onchange="actualizarTotal()">
                            </div>
                            
                            <div class="percentage-item">
                                <div class="percentage-label">Pruebas</div>
                                <div class="percentage-value">15%</div>
                                <input type="number" id="porcentajePruebas" class="percentage-input" 
                                       min="0" max="100" value="15" onchange="actualizarTotal()">
                            </div>
                            
                            <div class="percentage-item">
                                <div class="percentage-label">Asistencia</div>
                                <div class="percentage-value">10%</div>
                                <input type="number" id="porcentajeAsistencia" class="percentage-input" 
                                       min="0" max="100" value="10" onchange="actualizarTotal()">
                            </div>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">Total Configurado</div>
                                <div class="stat-value" id="totalPorcentaje">100%</div>
                                <div class="stat-trend" id="statusTotal">
                                    <i class="fa fa-check-circle"></i> Configuración válida
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Porcentaje Restante</div>
                                <div class="stat-value" id="porcentajeRestante">0%</div>
                                <div class="stat-trend">
                                    <i class="fa fa-balance-scale"></i> Distribución
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 5: ESTADÍSTICAS DEL SISTEMA -->
            <div class="content-grid">
                <div class="card fade-in">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fa fa-chart-pie"></i>
                            </div>
                            <h3>Estadísticas del Sistema</h3>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-sm btn-secondary" onclick="actualizarEstadisticas()">
                                <i class="fa fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">Estudiantes</div>
                                <div class="stat-value" id="statEstudiantes">0</div>
                                <div class="stat-trend">
                                    <i class="fa fa-users"></i> Registrados
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Indicadores</div>
                                <div class="stat-value" id="statIndicadores">15+</div>
                                <div class="stat-trend">
                                    <i class="fa fa-list-check"></i> PNFT Tech
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Evaluaciones</div>
                                <div class="stat-value" id="statEvaluaciones">0</div>
                                <div class="stat-trend">
                                    <i class="fa fa-clipboard-check"></i> Realizadas
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Configuración</div>
                                <div class="stat-value" id="statConfiguracion">0%</div>
                                <div class="stat-trend">
                                    <i class="fa fa-cog"></i> Completada
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 12px; margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="fa fa-rocket" style="color: #667eea;"></i>
                                <span style="font-size: 14px; color: var(--text-secondary);">
                                    Estado del sistema: <strong id="estadoSistema">Configuración inicial</strong>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN 6: ANÁLISIS INTELIGENTE (Califica.ai) -->
                <div class="card fade-in">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon" style="background: var(--gradient-success);">
                                <i class="fa fa-brain"></i>
                            </div>
                            <h3>Análisis Inteligente</h3>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-sm btn-success" onclick="generarRecomendacionesIA()">
                                <i class="fa fa-magic"></i> Analizar
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="analysis-section">
                            <div class="analysis-title">
                                <div class="ai-icon">
                                    <i class="fa fa-brain"></i>
                                </div>
                                <h4>Recomendaciones de Califica.ai</h4>
                            </div>
                            
                            <div class="recommendations-grid" id="recomendacionesContainer">
                                <!-- Las recomendaciones IA se cargarán aquí -->
                                <div class="recommendation-card">
                                    <div class="recommendation-header">
                                        <div class="rec-icon">
                                            <i class="fa fa-bolt"></i>
                                        </div>
                                        <div class="rec-title">Configuración Inicial</div>
                                    </div>
                                    <div class="rec-description">
                                        Complete la información de la institución y configure los porcentajes MEP para activar todas las funcionalidades.
                                    </div>
                                    <div class="rec-actions">
                                        <button class="btn btn-sm btn-primary" onclick="completarConfiguracion()">
                                            <i class="fa fa-cog"></i> Completar
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="recommendation-card">
                                    <div class="recommendation-header">
                                        <div class="rec-icon">
                                            <i class="fa fa-users"></i>
                                        </div>
                                        <div class="rec-title">Registrar Estudiantes</div>
                                    </div>
                                    <div class="rec-description">
                                        Importe su lista de estudiantes desde Excel/CSV o agreguelos manualmente para comenzar a evaluar.
                                    </div>
                                    <div class="rec-actions">
                                        <button class="btn btn-sm btn-success" onclick="irAEstudiantes()">
                                            <i class="fa fa-user-plus"></i> Agregar
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="recommendation-card">
                                    <div class="recommendation-header">
                                        <div class="rec-icon">
                                            <i class="fa fa-list-check"></i>
                                        </div>
                                        <div class="rec-title">Revisar Indicadores</div>
                                    </div>
                                    <div class="rec-description">
                                        La base PNFT para Formación Tecnológica ya está cargada con 15+ indicadores desde Maternal hasta Noveno.
                                    </div>
                                    <div class="rec-actions">
                                        <button class="btn btn-sm btn-secondary" onclick="verIndicadores()">
                                            <i class="fa fa-eye"></i> Ver
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- SCRIPT COMPLETO EMBEBIDO -->
    <script>
        // ==================== BASE DE DATOS INICIAL ====================
        const sistemaTecnoPIA = {
            // Configuración de la institución
            configuracion: {
                institucion: {
                    nombre: "Centro de Formación Tecnológica MEP",
                    direccion: "",
                    telefono: ""
                },
                docente: {
                    nombre: "",
                    cedula: "",
                    email: "",
                    telefono: ""
                },
                periodo: {
                    anio: "2024",
                    trimestre: "1",
                    fechaInicio: "",
                    fechaFin: ""
                },
                niveles: ["noveno"], // Niveles seleccionados
                porcentajes: {
                    cotidiano: 30,
                    tareas: 20,
                    proyectos: 25,
                    pruebas: 15,
                    asistencia: 10
                },
                fechaConfiguracion: null,
                completado: false
            },

            // Base de datos de niveles tecnológicos
            nivelesTecnologicos: [
                { id: "maternal", nombre: "Maternal", edad: "0-3 años", icono: "👶", color: "#FF6B8B" },
                { id: "transicion", nombre: "Transición", edad: "4-6 años", icono: "🌟", color: "#36D7B7" },
                { id: "primero", nombre: "Primero", edad: "6-7 años", icono: "1️⃣", color: "#3498DB" },
                { id: "segundo", nombre: "Segundo", edad: "7-8 años", icono: "2️⃣", color: "#9B59B6" },
                { id: "tercero", nombre: "Tercero", edad: "8-9 años", icono: "3️⃣", color: "#E74C3C" },
                { id: "cuarto", nombre: "Cuarto", edad: "9-10 años", icono: "4️⃣", color: "#1ABC9C" },
                { id: "quinto", nombre: "Quinto", edad: "10-11 años", icono: "5️⃣", color: "#F39C12" },
                { id: "sexto", nombre: "Sexto", edad: "11-12 años", icono: "6️⃣", color: "#2ECC71" },
                { id: "septimo", nombre: "Séptimo", edad: "12-13 años", icono: "7️⃣", color: "#9B59B6" },
                { id: "octavo", nombre: "Octavo", edad: "13-14 años", icono: "8️⃣", color: "#34495E" },
                { id: "noveno", nombre: "Noveno", edad: "14-15 años", icono: "9️⃣", color: "#E67E22" }
            ],

            // Estadísticas del sistema
            estadisticas: {
                totalEstudiantes: 0,
                totalIndicadores: 15,
                totalEvaluaciones: 0,
                configuracionCompletada: 0,
                ultimaActualizacion: null
            },

            // Base de datos de estudiantes (ejemplo inicial)
            estudiantes: [],

            // Base de datos de indicadores PNFT (ejemplo inicial)
            indicadores: []
        };

        // ==================== INICIALIZACIÓN DEL SISTEMA ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 TECNO-PIA - Sistema inicializando...');
            
            // 1. Configurar fechas por defecto
            configurarFechasPorDefecto();
            
            // 2. Cargar datos guardados
            cargarDatosGuardados();
            
            // 3. Inicializar interfaz
            inicializarInterfaz();
            
            // 4. Actualizar estadísticas
            actualizarEstadisticasUI();
            
            // 5. Mostrar notificación de bienvenida
            setTimeout(() => {
                mostrarNotificacion('✅ Sistema TECNO-PIA cargado correctamente', 'success');
            }, 1000);
            
            console.log('✅ Sistema inicializado correctamente');
        });

        function configurarFechasPorDefecto() {
            const hoy = new Date();
            const inicioAnio = new Date(hoy.getFullYear(), 0, 1);
            const finAnio = new Date(hoy.getFullYear(), 11, 31);
            
            document.getElementById('fechaInicio').value = inicioAnio.toISOString().split('T')[0];
            document.getElementById('fechaFin').value = finAnio.toISOString().split('T')[0];
        }

        function cargarDatosGuardados() {
            try {
                // Intentar cargar configuración guardada
                const configGuardada = localStorage.getItem('tecnoPIA_configuracion');
                if (configGuardada) {
                    sistemaTecnoPIA.configuracion = JSON.parse(configGuardada);
                    cargarConfiguracionEnUI();
                    console.log('📁 Configuración cargada desde almacenamiento');
                }
                
                // Cargar estudiantes
                const estudiantesGuardados = localStorage.getItem('tecnoPIA_estudiantes');
                if (estudiantesGuardados) {
                    sistemaTecnoPIA.estudiantes = JSON.parse(estudiantesGuardados);
                    sistemaTecnoPIA.estadisticas.totalEstudiantes = sistemaTecnoPIA.estudiantes.length;
                }
                
                // Cargar indicadores
                const indicadoresGuardados = localStorage.getItem('tecnoPIA_indicadores');
                if (indicadoresGuardados) {
                    sistemaTecnoPIA.indicadores = JSON.parse(indicadoresGuardados);
                    sistemaTecnoPIA.estadisticas.totalIndicadores = sistemaTecnoPIA.indicadores.length;
                }
                
            } catch (error) {
                console.error('Error cargando datos:', error);
                mostrarNotificacion('Error al cargar datos guardados', 'error');
            }
        }

        function cargarConfiguracionEnUI() {
            const config = sistemaTecnoPIA.configuracion;
            
            // Cargar datos de institución
            if (config.institucion.nombre) {
                document.getElementById('institucionNombre').value = config.institucion.nombre;
            }
            if (config.institucion.direccion) {
                document.getElementById('institucionDireccion').value = config.institucion.direccion;
            }
            
            // Cargar datos del docente
            if (config.docente.nombre) {
                document.getElementById('docenteNombre').value = config.docente.nombre;
            }
            if (config.docente.cedula) {
                document.getElementById('docenteCedula').value = config.docente.cedula;
            }
            if (config.docente.email) {
                document.getElementById('docenteEmail').value = config.docente.email;
            }
            if (config.docente.telefono) {
                document.getElementById('docenteTelefono').value = config.docente.telefono;
            }
            
            // Cargar período
            if (config.periodo.anio) {
                document.getElementById('anioLectivo').value = config.periodo.anio;
            }
            if (config.periodo.trimestre) {
                document.getElementById('periodoActual').value = config.periodo.trimestre;
            }
            if (config.periodo.fechaInicio) {
                document.getElementById('fechaInicio').value = config.periodo.fechaInicio;
            }
            if (config.periodo.fechaFin) {
                document.getElementById('fechaFin').value = config.periodo.fechaFin;
            }
            
            // Cargar porcentajes
            if (config.porcentajes) {
                document.getElementById('porcentajeCotidiano').value = config.porcentajes.cotidiano;
                document.getElementById('porcentajeTareas').value = config.porcentajes.tareas;
                document.getElementById('porcentajeProyectos').value = config.porcentajes.proyectos;
                document.getElementById('porcentajePruebas').value = config.porcentajes.pruebas;
                document.getElementById('porcentajeAsistencia').value = config.porcentajes.asistencia;
                actualizarTotal();
            }
        }

        function inicializarInterfaz() {
            // 1. Cargar niveles tecnológicos
            cargarNivelesTecnologicos();
            
            // 2. Configurar eventos
            configurarEventos();
            
            // 3. Actualizar estado del sistema
            actualizarEstadoSistema();
        }

        function cargarNivelesTecnologicos() {
            const container = document.getElementById('nivelesContainer');
            const niveles = sistemaTecnoPIA.nivelesTecnologicos;
            const nivelesSeleccionados = sistemaTecnoPIA.configuracion.niveles;
            
            let html = '';
            niveles.forEach(nivel => {
                const activo = nivelesSeleccionados.includes(nivel.id);
                html += `
                    <div class="level-card ${activo ? 'active' : ''}" data-id="${nivel.id}" onclick="toggleNivel('${nivel.id}')">
                        <div class="level-icon" style="background: linear-gradient(135deg, ${nivel.color}, ${nivel.color}80);">
                            ${nivel.icono}
                        </div>
                        <div class="level-name">${nivel.nombre}</div>
                        <div class="level-age">${nivel.edad}</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function toggleNivel(nivelId) {
            const niveles = sistemaTecnoPIA.configuracion.niveles;
            const index = niveles.indexOf(nivelId);
            
            if (index === -1) {
                niveles.push(nivelId);
            } else {
                niveles.splice(index, 1);
            }
            
            // Actualizar UI
            const card = document.querySelector(`.level-card[data-id="${nivelId}"]`);
            card.classList.toggle('active');
            
            // Actualizar estadísticas
            actualizarPorcentajeConfiguracion();
            
            mostrarNotificacion(`Nivel ${nivelId} ${index === -1 ? 'agregado' : 'removido'}`, 'info');
        }

        function seleccionarTodosNiveles() {
            const todosNiveles = sistemaTecnoPIA.nivelesTecnologicos.map(n => n.id);
            sistemaTecnoPIA.configuracion.niveles = [...todosNiveles];
            
            // Actualizar UI
            document.querySelectorAll('.level-card').forEach(card => {
                card.classList.add('active');
            });
            
            mostrarNotificacion('Todos los niveles seleccionados', 'success');
            actualizarPorcentajeConfiguracion();
        }

        function configurarEventos() {
            // Eventos para porcentajes
            const inputsPorcentaje = document.querySelectorAll('.percentage-input');
            inputsPorcentaje.forEach(input => {
                input.addEventListener('change', actualizarTotal);
                input.addEventListener('input', actualizarTotal);
            });
            
            // Eventos para fechas
            document.getElementById('fechaInicio').addEventListener('change', validarFechas);
            document.getElementById('fechaFin').addEventListener('change', validarFechas);
            
            // Eventos para campos de texto
            const camposTexto = document.querySelectorAll('.form-control[type="text"], .form-control[type="email"], .form-control[type="tel"]');
            camposTexto.forEach(campo => {
                campo.addEventListener('change', actualizarPorcentajeConfiguracion);
            });
        }

        // ==================== FUNCIONES PRINCIPALES ====================
        function guardarConfiguracion() {
            // 1. Recopilar datos del formulario
            recopilarDatosConfiguracion();
            
            // 2. Validar datos
            if (!validarConfiguracion()) {
                return;
            }
            
            // 3. Marcar como completado
            sistemaTecnoPIA.configuracion.completado = true;
            sistemaTecnoPIA.configuracion.fechaConfiguracion = new Date().toISOString();
            
            // 4. Guardar en localStorage
            guardarEnLocalStorage();
            
            // 5. Actualizar UI
            actualizarPorcentajeConfiguracion();
            actualizarEstadoSistema();
            
            // 6. Mostrar notificación
            mostrarNotificacion('✅ Configuración guardada exitosamente', 'success');
            
            // 7. Generar recomendaciones IA
            generarRecomendacionesIA();
        }

        function recopilarDatosConfiguracion() {
            const config = sistemaTecnoPIA.configuracion;
            
            // Información de la institución
            config.institucion.nombre = document.getElementById('institucionNombre').value.trim();
            config.institucion.direccion = document.getElementById('institucionDireccion').value.trim();
            config.institucion.telefono = document.getElementById('docenteTelefono').value.trim();
            
            // Información del docente
            config.docente.nombre = document.getElementById('docenteNombre').value.trim();
            config.docente.cedula = document.getElementById('docenteCedula').value.trim();
            config.docente.email = document.getElementById('docenteEmail').value.trim();
            config.docente.telefono = document.getElementById('docenteTelefono').value.trim();
            
            // Período lectivo
            config.periodo.anio = document.getElementById('anioLectivo').value;
            config.periodo.trimestre = document.getElementById('periodoActual').value;
            config.periodo.fechaInicio = document.getElementById('fechaInicio').value;
            config.periodo.fechaFin = document.getElementById('fechaFin').value;
            
            // Porcentajes
            config.porcentajes.cotidiano = parseInt(document.getElementById('porcentajeCotidiano').value) || 0;
            config.porcentajes.tareas = parseInt(document.getElementById('porcentajeTareas').value) || 0;
            config.porcentajes.proyectos = parseInt(document.getElementById('porcentajeProyectos').value) || 0;
            config.porcentajes.pruebas = parseInt(document.getElementById('porcentajePruebas').value) || 0;
            config.porcentajes.asistencia = parseInt(document.getElementById('porcentajeAsistencia').value) || 0;
            
            // Niveles ya están actualizados automáticamente
        }

        function validarConfiguracion() {
            const config = sistemaTecnoPIA.configuracion;
            const errores = [];
            
            // Validar información básica
            if (!config.institucion.nombre) {
                errores.push('Nombre de la institución es requerido');
            }
            
            if (!config.docente.nombre) {
                errores.push('Nombre del docente es requerido');
            }
            
            // Validar niveles seleccionados
            if (config.niveles.length === 0) {
                errores.push('Seleccione al menos un nivel');
            }
            
            // Validar porcentajes
            const totalPorcentajes = Object.values(config.porcentajes).reduce((a, b) => a + b, 0);
            if (totalPorcentajes !== 100) {
                errores.push(`Los porcentajes suman ${totalPorcentajes}%, deben sumar 100%`);
            }
            
            // Validar fechas
            if (config.periodo.fechaInicio && config.periodo.fechaFin) {
                const fechaInicio = new Date(config.periodo.fechaInicio);
                const fechaFin = new Date(config.periodo.fechaFin);
                
                if (fechaInicio > fechaFin) {
                    errores.push('La fecha de inicio no puede ser posterior a la fecha de fin');
                }
            }
            
            // Mostrar errores si existen
            if (errores.length > 0) {
                mostrarErrores(errores);
                return false;
            }
            
            return true;
        }

        function mostrarErrores(errores) {
            let mensaje = 'Corrija los siguientes errores:\n\n';
            errores.forEach((error, index) => {
                mensaje += `${index + 1}. ${error}\n`;
            });
            
            alert(mensaje);
            mostrarNotificacion('Hay errores en la configuración', 'error');
        }

        function guardarEnLocalStorage() {
            try {
                localStorage.setItem('tecnoPIA_configuracion', JSON.stringify(sistemaTecnoPIA.configuracion));
                localStorage.setItem('tecnoPIA_estudiantes', JSON.stringify(sistemaTecnoPIA.estudiantes));
                localStorage.setItem('tecnoPIA_indicadores', JSON.stringify(sistemaTecnoPIA.indicadores));
                localStorage.setItem('tecnoPIA_estadisticas', JSON.stringify(sistemaTecnoPIA.estadisticas));
                
                console.log('💾 Datos guardados en localStorage');
            } catch (error) {
                console.error('Error guardando datos:', error);
                mostrarNotificacion('Error al guardar los datos', 'error');
            }
        }

        // ==================== FUNCIONES DE PORCENTAJES ====================
        function actualizarTotal() {
            const cotidiano = parseInt(document.getElementById('porcentajeCotidiano').value) || 0;
            const tareas = parseInt(document.getElementById('porcentajeTareas').value) || 0;
            const proyectos = parseInt(document.getElementById('porcentajeProyectos').value) || 0;
            const pruebas = parseInt(document.getElementById('porcentajePruebas').value) || 0;
            const asistencia = parseInt(document.getElementById('porcentajeAsistencia').value) || 0;
            
            const total = cotidiano + tareas + proyectos + pruebas + asistencia;
            const restante = 100 - total;
            
            // Actualizar UI
            document.getElementById('totalPorcentaje').textContent = total + '%';
            document.getElementById('porcentajeRestante').textContent = restante + '%';
            
            // Actualizar estado
            const statusElement = document.getElementById('statusTotal');
            if (total === 100) {
                statusElement.innerHTML = '<i class="fa fa-check-circle"></i> Configuración válida';
                statusElement.style.color = '#2ed573';
            } else if (total > 100) {
                statusElement.innerHTML = '<i class="fa fa-exclamation-circle"></i> Excede 100%';
                statusElement.style.color = '#ff4757';
            } else {
                statusElement.innerHTML = '<i class="fa fa-info-circle"></i> Por completar';
                statusElement.style.color = '#ffa502';
            }
            
            // Actualizar estadísticas
            actualizarPorcentajeConfiguracion();
        }

        function aplicarPorcentajesMEP() {
            // Porcentajes estándar MEP para Formación Tecnológica
            document.getElementById('porcentajeCotidiano').value = 30;
            document.getElementById('porcentajeTareas').value = 20;
            document.getElementById('porcentajeProyectos').value = 25;
            document.getElementById('porcentajePruebas').value = 15;
            document.getElementById('porcentajeAsistencia').value = 10;
            
            actualizarTotal();
            mostrarNotificacion('✅ Porcentajes MEP aplicados', 'success');
        }

        function calcularPorcentajes() {
            // Lógica inteligente para calcular porcentajes óptimos
            const niveles = sistemaTecnoPIA.configuracion.niveles.length;
            
            if (niveles <= 3) {
                // Pocos niveles: más peso a evaluación continua
                document.getElementById('porcentajeCotidiano').value = 35;
                document.getElementById('porcentajeProyectos').value = 30;
                document.getElementById('porcentajeTareas').value = 15;
                document.getElementById('porcentajePruebas').value = 10;
                document.getElementById('porcentajeAsistencia').value = 10;
            } else if (niveles <= 6) {
                // Nivel intermedio
                document.getElementById('porcentajeCotidiano').value = 30;
                document.getElementById('porcentajeProyectos').value = 25;
                document.getElementById('porcentajeTareas').value = 20;
                document.getElementById('porcentajePruebas').value = 15;
                document.getElementById('porcentajeAsistencia').value = 10;
            } else {
                // Muchos niveles: estándar MEP
                aplicarPorcentajesMEP();
            }
            
            actualizarTotal();
            mostrarNotificacion('📊 Porcentajes calculados según niveles', 'info');
        }

        function validarFechas() {
            const fechaInicio = new Date(document.getElementById('fechaInicio').value);
            const fechaFin = new Date(document.getElementById('fechaFin').value);
            
            if (fechaInicio > fechaFin) {
                mostrarNotificacion('La fecha de inicio no puede ser posterior a la fecha de fin', 'error');
                document.getElementById('fechaFin').value = '';
            }
        }

        // ==================== FUNCIONES DE ESTADÍSTICAS ====================
        function actualizarEstadisticasUI() {
            const stats = sistemaTecnoPIA.estadisticas;
            
            document.getElementById('statEstudiantes').textContent = stats.totalEstudiantes;
            document.getElementById('statIndicadores').textContent = stats.totalIndicadores;
            document.getElementById('statEvaluaciones').textContent = stats.totalEvaluaciones;
            document.getElementById('statConfiguracion').textContent = stats.configuracionCompletada + '%';
            
            // Actualizar badges
            document.getElementById('badgeEstudiantes').textContent = stats.totalEstudiantes;
            document.getElementById('badgeIndicadores').textContent = stats.totalIndicadores;
        }

        function actualizarPorcentajeConfiguracion() {
            let porcentaje = 0;
            const config = sistemaTecnoPIA.configuracion;
            
            // Información de institución (15%)
            if (config.institucion.nombre) porcentaje += 15;
            
            // Información del docente (15%)
            if (config.docente.nombre) porcentaje += 15;
            
            // Niveles seleccionados (20%)
            if (config.niveles.length > 0) porcentaje += 20;
            
            // Porcentajes configurados (30%)
            const totalPorcentajes = Object.values(config.porcentajes).reduce((a, b) => a + b, 0);
            if (totalPorcentajes === 100) porcentaje += 30;
            
            // Fechas configuradas (20%)
            if (config.periodo.fechaInicio && config.periodo.fechaFin) porcentaje += 20;
            
            // Guardar estadística
            sistemaTecnoPIA.estadisticas.configuracionCompletada = porcentaje;
            document.getElementById('statConfiguracion').textContent = porcentaje + '%';
            
            // Actualizar estado del sistema
            actualizarEstadoSistema();
        }

        function actualizarEstadoSistema() {
            const porcentaje = sistemaTecnoPIA.estadisticas.configuracionCompletada;
            const estadoElement = document.getElementById('estadoSistema');
            
            if (porcentaje >= 80) {
                estadoElement.textContent = 'Óptimo';
                estadoElement.style.color = '#2ed573';
                document.getElementById('statusConfig').textContent = 'Completa';
            } else if (porcentaje >= 50) {
                estadoElement.textContent = 'Parcial';
                estadoElement.style.color = '#ffa502';
                document.getElementById('statusConfig').textContent = 'Parcial';
            } else {
                estadoElement.textContent = 'Configuración inicial';
                estadoElement.style.color = '#ff4757';
                document.getElementById('statusConfig').textContent = 'Inicial';
            }
        }

        // ==================== FUNCIONES DE ANÁLISIS IA (Califica.ai) ====================
        function generarRecomendacionesIA() {
            const container = document.getElementById('recomendacionesContainer');
            const config = sistemaTecnoPIA.configuracion;
            const stats = sistemaTecnoPIA.estadisticas;
            
            let recomendaciones = [];
            
            // Análisis de configuración
            if (stats.configuracionCompletada < 50) {
                recomendaciones.push({
                    icono: 'fa-bolt',
                    titulo: 'Configuración Incompleta',
                    descripcion: 'Complete al menos el 50% de la configuración para activar todas las funcionalidades.',
                    accion: 'completarConfiguracion',
                    textoAccion: 'Completar'
                });
            }
            
            // Análisis de estudiantes
            if (stats.totalEstudiantes === 0) {
                recomendaciones.push({
                    icono: 'fa-users',
                    titulo: 'Sin Estudiantes',
                    descripcion: 'No hay estudiantes registrados. Importe su lista o agregue estudiantes manualmente.',
                    accion: 'irAEstudiantes',
                    textoAccion: 'Agregar Estudiantes'
                });
            }
            
            // Análisis de niveles
            if (config.niveles.length === 1 && config.niveles[0] === 'noveno') {
                recomendaciones.push({
                    icono: 'fa-graduation-cap',
                    titulo: 'Niveles Limitados',
                    descripcion: 'Solo tiene configurado el nivel Noveno. Considere agregar más niveles si los atiende.',
                    accion: 'seleccionarTodosNiveles',
                    textoAccion: 'Agregar Niveles'
                });
            }
            
            // Análisis de porcentajes
            const totalPorcentajes = Object.values(config.porcentajes).reduce((a, b) => a + b, 0);
            if (totalPorcentajes !== 100) {
                recomendaciones.push({
                    icono: 'fa-percentage',
                    titulo: 'Porcentajes Desbalanceados',
                    descripcion: `Los porcentajes suman ${totalPorcentajes}%. Aplique el estándar MEP para evaluación equilibrada.`,
                    accion: 'aplicarPorcentajesMEP',
                    textoAccion: 'Aplicar MEP'
                });
            }
            
            // Recomendación de evaluación
            if (stats.totalEstudiantes > 0 && stats.configuracionCompletada >= 80) {
                recomendaciones.push({
                    icono: 'fa-clipboard-check',
                    titulo: 'Listo para Evaluar',
                    descripcion: 'El sistema está configurado correctamente. Comience a evaluar a sus estudiantes.',
                    accion: 'irAEvaluacion',
                    textoAccion: 'Comenzar Evaluación'
                });
            }
            
            // Generar HTML de recomendaciones
            let html = '';
            recomendaciones.forEach(rec => {
                html += `
                    <div class="recommendation-card">
                        <div class="recommendation-header">
                            <div class="rec-icon">
                                <i class="fa ${rec.icono}"></i>
                            </div>
                            <div class="rec-title">${rec.titulo}</div>
                        </div>
                        <div class="rec-description">${rec.descripcion}</div>
                        <div class="rec-actions">
                            <button class="btn btn-sm btn-primary" onclick="${rec.accion}()">
                                <i class="fa fa-play-circle"></i> ${rec.textoAccion}
                            </button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<div style="color: var(--text-secondary); text-align: center; padding: 20px;">No hay recomendaciones en este momento.</div>';
            
            mostrarNotificacion('✅ Análisis IA completado', 'success');
        }

        function analizarRecomendaciones() {
            mostrarNotificacion('🤖 Analizando datos del sistema...', 'info');
            
            // Simular análisis IA
            setTimeout(() => {
                generarRecomendacionesIA();
            }, 1500);
        }

        // ==================== FUNCIONES DE NAVEGACIÓN ====================
        function cargarModulo(modulo) {
            mostrarNotificacion(`Cargando módulo ${modulo}...`, 'info');
            // En un sistema real, aquí se cargaría el módulo correspondiente
            // Por ahora simulamos la navegación
            setTimeout(() => {
                mostrarNotificacion(`Módulo ${modulo} listo`, 'success');
            }, 500);
        }

        function irAEstudiantes() {
            mostrarNotificacion('Redirigiendo a gestión de estudiantes...', 'info');
            // En implementación completa, redirigiría a estudiantes.html
        }

        function verIndicadores() {
            mostrarNotificacion('Redirigiendo a indicadores PNFT...', 'info');
            // En implementación completa, redirigiría a indicadores.html
        }

        function completarConfiguracion() {
            // Auto-completar configuración con datos de ejemplo
            cargarDatosEjemplo();
            guardarConfiguracion();
        }

        function irAEvaluacion() {
            mostrarNotificacion('Redirigiendo a evaluación cotidiana...', 'info');
            // En implementación completa, redirigiría a cotidiano.html
        }

        // ==================== FUNCIONES DE UTILIDAD ====================
        function cargarDatosEjemplo() {
            // Datos de ejemplo para pruebas
            document.getElementById('institucionNombre').value = 'Centro Educativo Tecnológico MEP';
            document.getElementById('institucionDireccion').value = 'San José, Costa Rica';
            document.getElementById('docenteNombre').value = 'Prof. Juan Pérez Rodríguez';
            document.getElementById('docenteCedula').value = '1-2345-6789';
            document.getElementById('docenteEmail').value = 'juan.perez@mep.ed.cr';
            document.getElementById('docenteTelefono').value = '(506) 2222-3333';
            
            // Seleccionar todos los niveles
            seleccionarTodosNiveles();
            
            // Aplicar porcentajes MEP
            aplicarPorcentajesMEP();
            
            mostrarNotificacion('📋 Datos de ejemplo cargados', 'info');
        }

        function exportarConfiguracion() {
            const config = sistemaTecnoPIA.configuracion;
            
            // Crear contenido para exportación
            let contenido = `CONFIGURACIÓN TECNO-PIA - FORMACIÓN TECNOLÓGICA\n`;
            contenido += `===================================================\n\n`;
            contenido += `INSTITUCIÓN: ${config.institucion.nombre}\n`;
            contenido += `DOCENTE: ${config.docente.nombre}\n`;
            contenido += `CÉDULA: ${config.docente.cedula}\n`;
            contenido += `EMAIL: ${config.docente.email}\n`;
            contenido += `TELÉFONO: ${config.docente.telefono}\n\n`;
            contenido += `PERÍODO: ${config.periodo.anio} - Trimestre ${config.periodo.trimestre}\n`;
            contenido += `FECHA INICIO: ${config.periodo.fechaInicio}\n`;
            contenido += `FECHA FIN: ${config.periodo.fechaFin}\n\n`;
            contenido += `NIVELES: ${config.niveles.map(n => n.toUpperCase()).join(', ')}\n\n`;
            contenido += `PORCENTAJES DE EVALUACIÓN:\n`;
            contenido += `• Trabajo Cotidiano: ${config.porcentajes.cotidiano}%\n`;
            contenido += `• Tareas Tecnológicas: ${config.porcentajes.tareas}%\n`;
            contenido += `• Proyectos Tech: ${config.porcentajes.proyectos}%\n`;
            contenido += `• Pruebas: ${config.porcentajes.pruebas}%\n`;
            contenido += `• Asistencia: ${config.porcentajes.asistencia}%\n`;
            contenido += `TOTAL: ${Object.values(config.porcentajes).reduce((a, b) => a + b, 0)}%\n\n`;
            contenido += `FECHA DE EXPORTACIÓN: ${new Date().toLocaleString('es-CR')}\n`;
            contenido += `SISTEMA: TECNO-PIA v1.0 (EXCEVAL + Califica.ai)\n`;
            
            // Crear y descargar archivo
            const blob = new Blob([contenido], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `configuracion_tecnoPIA_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            mostrarNotificacion('✅ Configuración exportada exitosamente', 'success');
        }

        // ==================== SISTEMA DE NOTIFICACIONES ====================
        function mostrarNotificacion(mensaje, tipo = 'info') {
            const notificacion = document.createElement('div');
            notificacion.className = `notification ${tipo}`;
            notificacion.innerHTML = `
                <div class="notification-icon">
                    <i class="fa ${tipo === 'success' ? 'fa-check-circle' : tipo === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                </div>
                <div class="notification-content">
                    <p>${mensaje}</p>
                </div>
                <button class="notification-close" onclick="this.parentElement.remove()">
                    <i class="fa fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(notificacion);
            
            // Auto-eliminar después de 5 segundos
            setTimeout(() => {
                if (notificacion.parentNode) {
                    notificacion.style.animation = 'slideOut 0.3s ease-out';
                    setTimeout(() => {
                        if (notificacion.parentNode) {
                            notificacion.parentNode.removeChild(notificacion);
                        }
                    }, 300);
                }
            }, 5000);
        }

        // ==================== INICIALIZACIÓN FINAL ====================
        console.log('🎯 TECNO-PIA - Módulo Principal listo');
        console.log('🔧 Características implementadas:');
        console.log('   • Glassmorphism completo');
        console.log('   • Base de datos embebida');
        console.log('   • Sistema de configuración MEP');
        console.log('   • Análisis inteligente (Califica.ai)');
        console.log('   • Estadísticas en tiempo real');
        console.log('   • Notificaciones del sistema');
        console.log('   • Exportación de datos');
        console.log('   • Niveles Maternal a Noveno');
        console.log('   • Porcentajes MEP configurables');
        
        // Inicializar cálculos iniciales
        actualizarTotal();
        actualizarPorcentajeConfiguracion();
    </script>
</body>
</html>
